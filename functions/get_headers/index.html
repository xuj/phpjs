
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript get_headers function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript get_headers function A JavaScript equivalent of PHP&#8217;s get_headers url/get_headers.js raw on github 1
2
3
4
5
6
7
8
9
10
11
12
13
14 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/get_headers/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <a target="_blank" href="https://github.com/kvz/phpjs">
    <img id="fork-us" style="position: fixed; z-index: 99; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub">
  </a>
  <header role="banner"><hgroup>
  <div id="logo">
    <h1><a href="/">php.js</a></h1>
  	<div class="clear"></div>
  </div>

  
  
    <h2>Learn how to do it in JavaScript. Explore boundaries porting languages. Use functions that turn out to be useful.</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
  <li><a target="_blank" href="https://github.com/kvz/phpjs/wiki/_pages">Wiki</a></li>
  <li><a target="_blank"  href="http://twitter.com/phpjs">@phpjs</a></li>
  <li><a target="_blank"  href="http://identi.ca/brettz9">@brettz9</a></li>
  <li><a target="_blank"  href="http://twitter.com/kvz">@kvz</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript get_headers function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s get_headers</p>

<figure class='code'><figcaption><span>url/get_headers.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/url/get_headers.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">get_headers</span> <span class="p">(</span><span class="nx">url</span><span class="p">,</span> <span class="nx">format</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// +   original by: Paulo Freitas</span>
</span><span class='line'>  <span class="c1">// +    bugfixed by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// -    depends on: array_filter</span>
</span><span class='line'>  <span class="c1">// %        note 1: This function uses XmlHttpRequest and cannot retrieve resource from different domain.</span>
</span><span class='line'>  <span class="c1">// %        note 1: Synchronous so may lock up browser, mainly here for study purposes.</span>
</span><span class='line'>  <span class="c1">// *     example 1: get_headers(&#39;http://kevin.vanzonneveld.net/pj_test_supportfile_1.htm&#39;)[0];</span>
</span><span class='line'>  <span class="c1">// *     returns 1: &#39;Date: Wed, 13 May 2009 23:53:11 GMT&#39;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">req</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">.</span><span class="nx">ActiveXObject</span> <span class="o">?</span> <span class="k">new</span> <span class="nx">ActiveXObject</span><span class="p">(</span><span class="s2">&quot;Microsoft.XMLHTTP&quot;</span><span class="p">)</span> <span class="o">:</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">throw</span> <span class="k">new</span> <span class="nb">Error</span><span class="p">(</span><span class="s1">&#39;XMLHttpRequest not supported&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">tmp</span><span class="p">,</span> <span class="nx">headers</span><span class="p">,</span> <span class="nx">pair</span><span class="p">,</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">req</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="s1">&#39;HEAD&#39;</span><span class="p">,</span> <span class="nx">url</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">req</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">readyState</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">req</span><span class="p">.</span><span class="nx">getAllResponseHeaders</span><span class="p">();</span>
</span><span class='line'>  <span class="nx">tmp</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;\n&#39;</span><span class="p">);</span>
</span><span class='line'>  <span class="nx">tmp</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">array_filter</span><span class="p">(</span><span class="nx">tmp</span><span class="p">,</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">value</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">value</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">!==</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="p">});</span>
</span><span class='line'>  <span class="nx">headers</span> <span class="o">=</span> <span class="nx">format</span> <span class="o">?</span> <span class="p">{}</span> <span class="o">:</span> <span class="p">[];</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="k">in</span> <span class="nx">tmp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">format</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">pair</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">headers</span><span class="p">[</span><span class="nx">pair</span><span class="p">.</span><span class="nx">splice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span> <span class="o">=</span> <span class="nx">pair</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">).</span><span class="nx">substring</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">headers</span><span class="p">[</span><span class="nx">j</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">headers</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/url/get_headers.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/url/get_headers.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">get_headers</span><span class="p">(</span><span class="s1">&#39;http://kevin.vanzonneveld.net/pj_test_supportfile_1.htm&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;Date: Wed, 13 May 2009 23:53:11 GMT&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the url extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/base64_decode">base64_decode</a></li>
<li><a href="/functions/base64_encode">base64_encode</a></li>
<li><a href="/functions/get_headers">get_headers</a></li>
<li><a href="/functions/get_meta_tags">get_meta_tags</a></li>
<li><a href="/functions/http_build_query">http_build_query</a></li>
<li><a href="/functions/parse_url">parse_url</a></li>
<li><a href="/functions/rawurldecode">rawurldecode</a></li>
<li><a href="/functions/rawurlencode">rawurlencode</a></li>
<li><a href="/functions/urldecode">urldecode</a></li>
<li><a href="/functions/urlencode">urlencode</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2012-06-16 06:52:05 <br />
@T.Wild: Forgot to let you know the dependency line was added. Thanks!
<hr />


<strong>
T.Wild
</strong>
on 2012-01-27 18:03:15 <br />
This should be marked as having a dependency on array_filter (line 23) or be recoded.
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2010-11-22 07:25:13 <br />
@Joey: Due to security restrictions in JavaScript, this function can only work if the script you are trying to get is on the same domain (or if the site you are targeting is granting HTML5 CORS access and browsers support it).
<hr />


<strong>
Joey
</strong>
on 2010-11-21 15:27:04 <br />
I have a problem whit the http header the page give 303 see other, but i need the headers of tha page! But the function don&#8217;t show how to fix.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-12-10 16:46:24 <br />
@ Paulo Ricardo F. Santos: hehe, no problem! Thanks for giving the final function complete though, makes my job a little easier :)
<hr />


<strong>
Paulo Ricardo F. Santos
</strong>
on 2008-12-04 23:20:01 <br />
OMG! Sorry for the flood and ignore my last 2 comments (#7 and #8 - I was quite confused). Here&#8217;s the function with corrections:

<pre><code>
function get_headers(url, format) {
    var req = window.ActiveXObject ? new ActiveXObject(&amp;quot;Microsoft.XMLHTTP&amp;quot;) : new XMLHttpRequest();
    if (!req) throw new Error('XMLHttpRequest not supported');
    var tmp, headers, pair, i;
 
    req.open('HEAD', url, false);
    req.send(null);

    if (req.readyState &amp;lt; 3) {
        return false;
    }

    tmp = req.getAllResponseHeaders();alert(tmp);
    tmp = tmp.split('\n');
    tmp = array_filter(tmp, function (value) { return value.substring(1) != ''; });
    headers = [req.status + ' ' + req.statusText];
 
    for (i in tmp) {
        if (format) {
            pair = tmp[i].split(':');
            headers[pair.splice(0, 1)] = pair.join(':').substring(1);
        } else {
            headers[headers.length] = tmp[i];
        }
    }

    return headers;
}
</code></pre>
About the Opera problem, I don&#8217;t know how to fix it. In my tests, Opera 9.62 returned a empty string in statusText property and getAllResponseHeaders() function - only status property returned as expected. Both Firefox 3 and IE 7 worked perfectly. :)
<hr />


<strong>
Paulo Ricardo F. Santos
</strong>
on 2008-12-04 16:51:53 <br />
Ah! This line:

<pre><code>headers[pair.splice(0, 1)] = pair.join(':').replace(/^\s+|\s+$/g, '');</code></pre>

might be only this, there&#8217;s no difference:

<pre><code>headers[pair.splice(0, 1)] = pair.join(':');</code></pre>

And as far I&#8217;ve noted, to work properly in Opera, the AJAX request should be asynchronized, as here: http://www.ceciliadassi.com/get_headers2.js. Synchronized requests returns false in the most of times. ;/
<hr />


<strong>
Paulo Ricardo F. Santos
</strong>
on 2008-12-04 16:17:03 <br />
Hmm, might be useful replace

<pre><code>tmp.pop();</code></pre>

to

<pre><code>tmp = array_filter(tmp, function (str) { return str.replace(/^\s+|\s+$/g, '') != ''; });</code></pre>

to avoid any unexpected problem. ;)
<hr />


<strong>
Paulo Ricardo F. Santos
</strong>
on 2008-12-04 14:54:40 <br />
Oops, sorry for the inconvenient - it&#8217;s a bit buggy and I don&#8217;t know how it worked before.

This snippet should fixes all the problems:

<pre><code>    tmp = req.getAllResponseHeaders().split('\n');
    tmp.pop();
    headers = [req.status + ' ' + req.statusText];
 
    for (i in tmp) {
        if (format) {
            pair = tmp[i].split(':');
            headers[pair.splice(0, 1)] = pair.join(':').replace(/^\s+|\s+$/g, '');
        } else {
            headers[headers.length] = tmp[i];
        }
    }</code></pre>

Here&#8217;s a temporary demo - working as expected: http://www.ceciliadassi.com/get_headers.html

[]&#8217;s
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-12-03 14:14:46 <br />
@ Paulo Ricardo F. Santos: I&#8217;m testing from console using the ./phpjstest.php file in the _tools directory in svn. But what&#8217;s strange is that code from file_size (which I thought was identical) does not break.
<hr />


<strong>
Paulo Ricardo F. Santos
</strong>
on 2008-12-03 13:26:51 <br />
@ Kevin: Ah! Well&#8230; how you are testing? AFAIK, there&#8217;s no way to test it locally or request a cross-domain address. I&#8217;ve tested it on my test domain, requesting a file from same server. ;)
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-12-03 12:58:34 <br />
@ Paulo Ricardo F. Santos: Well I haven&#8217;t got it working yet, so that&#8217;s why the examples are still in a copy-pasted state.
<hr />


<strong>
Paulo Ricardo F. Santos
</strong>
on 2008-12-03 12:56:47 <br />
@ Kevin: Hmm, great idea, I forgot this possible abnormal behavior! &amp;gt;.&amp;lt;

Ah!, man, I don&#8217;t understood your example. Why it should returns 123? o.O
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-12-03 11:34:51 <br />
@ Paulo Ricardo F. Santos: In my test suite: phpjstest.php, readyState would stay at 1, I had to build a condition &amp;lt; 3 to avoid the function from crashing. Very strange, because the file_exists function uses the same code and that works ok.
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/get_headers/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/get_headers/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Kevin van Zonneveld -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/get_headers/index.html';
        var disqus_url = 'http://phpjs.org/functions/get_headers/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
