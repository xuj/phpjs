
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript defined function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript defined function A JavaScript equivalent of PHP&#8217;s defined misc/defined.js raw on github 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/defined/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<a target="_blank" href="https://github.com/kvz/phpjs">
  <img id="fork-us" style="position: absolute; z-index: 99; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub">
</a>
<body   class="no-sidebar"  >
  <header role="banner"><hgroup>
  <div id="logo">
    <h1><a href="/">php.js</a></h1>
  	<div class="clear"></div>
  </div>

  
  
    <h2>Learn how to do it in JavaScript. Explore boundaries porting languages. Enjoy functions that turn out to be useful.</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript defined function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s defined</p>

<figure class='code'><figcaption><span>misc/defined.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/misc/defined.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">defined</span> <span class="p">(</span><span class="nx">constant_name</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// http://kevin.vanzonneveld.net</span>
</span><span class='line'>  <span class="c1">// +   original by: Waldo Malqui Silva</span>
</span><span class='line'>  <span class="c1">// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span>
</span><span class='line'>  <span class="c1">// +    revised by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// %          note 1: Because this function can (albeit only temporarily) overwrite a global variable,</span>
</span><span class='line'>  <span class="c1">// %          note 1: it is not thread-safe (normally not a concern for JavaScript, but would be if used</span>
</span><span class='line'>  <span class="c1">// %          note 1: in a threaded environment, e.g., DOM worker threads)</span>
</span><span class='line'>  <span class="c1">// *     example 1: defined(&#39;IMAGINARY_CONSTANT1&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 1: false</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">tmp</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">[</span><span class="nx">constant_name</span><span class="p">];</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">[</span><span class="nx">constant_name</span><span class="p">]</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">[</span><span class="nx">constant_name</span><span class="p">]</span> <span class="o">?</span> <span class="s1">&#39;changed&#39;</span> <span class="o">+</span> <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">[</span><span class="nx">constant_name</span><span class="p">].</span><span class="nx">toString</span><span class="p">()</span> <span class="o">:</span> <span class="s1">&#39;changed&#39;</span><span class="p">;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">returnval</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">[</span><span class="nx">constant_name</span><span class="p">]</span> <span class="o">===</span> <span class="nx">tmp</span><span class="p">;</span>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">returnval</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// Reset</span>
</span><span class='line'>    <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">[</span><span class="nx">constant_name</span><span class="p">]</span> <span class="o">=</span> <span class="nx">tmp</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">returnval</span><span class="p">;</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/misc/defined.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/misc/defined.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">defined</span><span class="p">(</span><span class="s1">&#39;IMAGINARY_CONSTANT1&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kc">false</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the misc extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/constant">constant</a></li>
<li><a href="/functions/define">define</a></li>
<li><a href="/functions/defined">defined</a></li>
<li><a href="/functions/pack">pack</a></li>
<li><a href="/functions/php_strip_whitespace">php_strip_whitespace</a></li>
<li><a href="/functions/time_sleep_until">time_sleep_until</a></li>
<li><a href="/functions/uniqid">uniqid</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
Xexys
</strong>
on 2012-09-01 17:09:46 <br />
Hello!
I&#8217;m trying to use such construction

<pre><code>
if (!defined('MY_CONST'))
        define('MY_CONST', &quot;some text&quot;);
</code></pre>

And I get an error &#8216;TypeError: redeclaration of var MY_CONST&#8217;

but this works correct

<pre><code>
if (!defined('MY_CONST')) {
        delete MY_CONST;
        define('MY_CONST', &quot;some text&quot;);
}
</code></pre>

May be you can fix?
<hr />


<strong>
<a href="http://an3m1.com/" rel="nofollow">????? ????? ???</a>
</strong>
on 2012-04-11 15:43:41 <br />
I agree it is a very informative article and I actually enjoy reading good stuff unlike all the crap out there on the internet
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2012-02-06 04:25:16 <br />
@danny morabito: This is not just checking whether a variable exists. In such a case &quot;return this.window[const_name] !== undefined&quot; would work. This is looking for a genuine constant which cannot be altered.
<hr />


<strong>
<a href="http://www.newsocialife.com" rel="nofollow">danny morabito</a>
</strong>
on 2012-02-05 20:33:35 <br />
sorry, but isn&#8217;t simplier:
<pre><code>
return this.window[const_name] === undefined ? false: true;
</code></pre>
?
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-26 12:45:29 <br />
As far as the callbacks-as-strings, on second thought, just using window[funcName]() (or building a function with an inner function if hard-wiring arguments is needed) avoids the eval()ish nature of setTimeout-with-1st-arg-as-string. But it was a fun thought&#8230; :)
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2009-01-25 14:58:09 <br />
@ Brett Zamir: You convinced me! Interesting idea about the callbacks as well!
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-23 17:04:03 <br />
Ok, as far as &amp;quot;not-null&amp;quot;, that should be changed to &amp;quot;changed&amp;quot; (to be more clear). That is just providing some way to ensure that an undefined variable will return false (since &amp;quot;changed&amp;quot; will not equal &#8216;undefined&#8217;). We need to do some test for whether it is defined, since it will otherwise throw an error. This is safe since the value will be reset back to its original value (in this case to undefined).

As far as the NaN issue in the function&#8230; NaN is actually is considered to be typeof number, but that was redundant, and I shouldn&#8217;t have handled it as a constant anyways because I&#8217;ve since discovered NaN, Infinity, and undefined are all variables in JavaScript&#8211;you can change them!

The only way that adding the &#8216;changed&#8217; keyword to the &amp;quot;variable&amp;quot; could result in the same value as the original temporary variable is if the original was a constant. For example, (non-constant) objects or arrays will have their toString() methods called, but they will get an additional string &amp;quot;changed&amp;quot; appended, so they can never match (and thus the variable will get set back to its original value).

As far as failing, I don&#8217;t see any reason which could cause it to fail&#8211;do you? (if it crashed at that point, the changed variable would be meaningless anyways). 

As far as a parallel process, even if the person is using a setTimeout &amp;quot;thread&amp;quot;, my understanding is that the function must fully complete before yielding since JavaScript doesn&#8217;t have true threads. So the variable should always get set back, as far as I can tell.

(Off the subject, but speaking of setTimeout, I just realized we could allow passing of PHP-style callbacks-as-strings into JavaScript functions by calling setTimeout with a 0 ms timeout (optionally building arguments to pass in as necessary).)

<pre><code>
var a = function(b){alert('aaa');}
runCallback('a')
function runCallback (cb) {
    var a = setTimeout(cb+&amp;quot;()&amp;quot;,0) 
}
</code></pre>

Ok, now here&#8217;s the simplified defined() function:

<pre><code>function defined (constant) {
    var tmp = window[constant];
    window[constant] = window[constant] ? 'changed'+window[constant].toString() : 'changed';
    var returnval = window[constant] === tmp;
    if (!returnval) { // Reset
        window[constant] = tmp;
    }
    return returnval;
}</code></pre>
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-12-30 12:33:35 <br />
@ Brett Zamir: If I&#8217;m not mistaken you are reassigning the variable a value to make sure it really is a constant.

If it&#8217;s not set, you set it to not-null? That part I don&#8217;t get.
Then, if it&#8217;s a number AND it&#8217;s not a number (?!) and the types of the original &amp;amp; newly set var do not match you reset it to it&#8217;s original value. But if they do match you leave the &#8216;changed&#8217; keyword there? I don&#8217;t understand that.

One concern that comes to surface is that you are changing a user variable (if they accidentally specify a variable instead of a const).

If the function fails or there is a parallel process, a the changed value will be returned.

Could you explain a bit more about this approach? I&#8217;m just not getting it I guess.
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2008-12-21 07:41:18 <br />
Whoops&#8230; forgot to reassign the variable I temporarily changed:

<pre><code>function defined (constant) {
    var returnval;
    var tmp = window[constant];    
    window[constant] = window[constant] ? 'changed'+window[constant].toString() : 'not-null';
    if (typeof window[constant] === 'number' &amp;amp;&amp;amp; isNaN(window[constant])) { // NaN
        returnval = typeof tmp === typeof window[constant];
        if (!returnval) {
            window[constant] = tmp;
        }
        return returnval;
    }
    returnval = window[constant] === tmp;
    if (!returnval) {
        window[constant] = tmp;
    }
    return returnval;
}
</code></pre>
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2008-12-21 02:42:10 <br />
Here&#8217;s an implementation which works with the &#8216;const&#8217; keyword. Tested with NaN, booleans, numbers, strings, arrays, objects, regular expression literals.

<pre><code>
const a = 5;
var b = 5;
alert(defined('a')); // true 
alert(defined('b'));  // false

function defined (constant) {
    var tmp = window[constant];    
    window[constant] = window[constant] ? 'changed'+window[constant].toString() : 'not-null';
    if (typeof window[constant] === 'number' &amp;amp;&amp;amp; isNaN(window[constant])) { // NaN
        return typeof tmp === typeof window[constant];
    }
    return window[constant] === tmp;
}
</code></pre>
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/defined/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/defined/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - <a href="http://twitter.com/kvz">Kevin van Zonneveld</a> 
  and <a href="/authors/">contributors</a> -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/defined/index.html';
        var disqus_url = 'http://phpjs.org/functions/defined/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
