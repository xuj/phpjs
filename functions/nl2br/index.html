
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript nl2br function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript nl2br function A JavaScript equivalent of PHP&#8217;s nl2br strings/nl2br.js raw on github 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/nl2br/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <a target="_blank" href="https://github.com/kvz/phpjs">
    <img id="fork-us" style="position: absolute; z-index: 99; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub">
  </a>
  <header role="banner"><hgroup>
  <div id="logo">
    <h1><a href="/">php.js</a></h1>
  	<div class="clear"></div>
  </div>

  
  
    <h2>Learn how to do it in JavaScript. Explore boundaries porting languages. Enjoy functions that turn out to be useful.</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript nl2br function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s nl2br</p>

<figure class='code'><figcaption><span>strings/nl2br.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/strings/nl2br.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">nl2br</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">is_xhtml</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// http://kevin.vanzonneveld.net</span>
</span><span class='line'>  <span class="c1">// +   original by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span>
</span><span class='line'>  <span class="c1">// +   improved by: Philip Peterson</span>
</span><span class='line'>  <span class="c1">// +   improved by: Onno Marsman</span>
</span><span class='line'>  <span class="c1">// +   improved by: Atli Þór</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Onno Marsman</span>
</span><span class='line'>  <span class="c1">// +      input by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span>
</span><span class='line'>  <span class="c1">// +   improved by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// +   improved by: Maximusya</span>
</span><span class='line'>  <span class="c1">// *     example 1: nl2br(&#39;Kevin\nvan\nZonneveld&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 1: &#39;Kevin&lt;br /&gt;\nvan&lt;br /&gt;\nZonneveld&#39;</span>
</span><span class='line'>  <span class="c1">// *     example 2: nl2br(&quot;\nOne\nTwo\n\nThree\n&quot;, false);</span>
</span><span class='line'>  <span class="c1">// *     returns 2: &#39;&lt;br&gt;\nOne&lt;br&gt;\nTwo&lt;br&gt;\n&lt;br&gt;\nThree&lt;br&gt;\n&#39;</span>
</span><span class='line'>  <span class="c1">// *     example 3: nl2br(&quot;\nOne\nTwo\n\nThree\n&quot;, true);</span>
</span><span class='line'>  <span class="c1">// *     returns 3: &#39;&lt;br /&gt;\nOne&lt;br /&gt;\nTwo&lt;br /&gt;\n&lt;br /&gt;\nThree&lt;br /&gt;\n&#39;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">breakTag</span> <span class="o">=</span> <span class="p">(</span><span class="nx">is_xhtml</span> <span class="o">||</span> <span class="k">typeof</span> <span class="nx">is_xhtml</span> <span class="o">===</span> <span class="s1">&#39;undefined&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s1">&#39;&lt;br &#39;</span> <span class="o">+</span> <span class="s1">&#39;/&gt;&#39;</span> <span class="o">:</span> <span class="s1">&#39;&lt;br&gt;&#39;</span><span class="p">;</span> <span class="c1">// Adjust comment to avoid issue on phpjs.org display</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="p">(</span><span class="nx">str</span> <span class="o">+</span> <span class="s1">&#39;&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/([^&gt;\r\n]?)(\r\n|\n\r|\r|\n)/g</span><span class="p">,</span> <span class="s1">&#39;$1&#39;</span> <span class="o">+</span> <span class="nx">breakTag</span> <span class="o">+</span> <span class="s1">&#39;$2&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/strings/nl2br.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/strings/nl2br.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">nl2br</span><span class="p">(</span><span class="s1">&#39;Kevin\nvan\nZonneveld&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;Kevin&lt;br /&gt;\nvan&lt;br /&gt;\nZonneveld&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Example 2</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">nl2br</span><span class="p">(</span><span class="s2">&quot;\nOne\nTwo\n\nThree\n&quot;</span><span class="p">,</span> <span class="kc">false</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;&lt;br&gt;\nOne&lt;br&gt;\nTwo&lt;br&gt;\n&lt;br&gt;\nThree&lt;br&gt;\n&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Example 3</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">nl2br</span><span class="p">(</span><span class="s2">&quot;\nOne\nTwo\n\nThree\n&quot;</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;&lt;br /&gt;\nOne&lt;br /&gt;\nTwo&lt;br /&gt;\n&lt;br /&gt;\nThree&lt;br /&gt;\n&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the strings extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/addcslashes">addcslashes</a></li>
<li><a href="/functions/addslashes">addslashes</a></li>
<li><a href="/functions/bin2hex">bin2hex</a></li>
<li><a href="/functions/chop">chop</a></li>
<li><a href="/functions/chr">chr</a></li>
<li><a href="/functions/chunk_split">chunk_split</a></li>
<li><a href="/functions/convert_cyr_string">convert_cyr_string</a></li>
<li><a href="/functions/convert_uuencode">convert_uuencode</a></li>
<li><a href="/functions/count_chars">count_chars</a></li>
<li><a href="/functions/crc32">crc32</a></li>
<li><a href="/functions/echo">echo</a></li>
<li><a href="/functions/explode">explode</a></li>
<li><a href="/functions/get_html_translation_table">get_html_translation_table</a></li>
<li><a href="/functions/html_entity_decode">html_entity_decode</a></li>
<li><a href="/functions/htmlentities">htmlentities</a></li>
<li><a href="/functions/htmlspecialchars">htmlspecialchars</a></li>
<li><a href="/functions/htmlspecialchars_decode">htmlspecialchars_decode</a></li>
<li><a href="/functions/implode">implode</a></li>
<li><a href="/functions/join">join</a></li>
<li><a href="/functions/lcfirst">lcfirst</a></li>
<li><a href="/functions/levenshtein">levenshtein</a></li>
<li><a href="/functions/localeconv">localeconv</a></li>
<li><a href="/functions/ltrim">ltrim</a></li>
<li><a href="/functions/md5">md5</a></li>
<li><a href="/functions/md5_file">md5_file</a></li>
<li><a href="/functions/metaphone">metaphone</a></li>
<li><a href="/functions/money_format">money_format</a></li>
<li><a href="/functions/nl2br">nl2br</a></li>
<li><a href="/functions/nl_langinfo">nl_langinfo</a></li>
<li><a href="/functions/number_format">number_format</a></li>
<li><a href="/functions/ord">ord</a></li>
<li><a href="/functions/parse_str">parse_str</a></li>
<li><a href="/functions/printf">printf</a></li>
<li><a href="/functions/quoted_printable_decode">quoted_printable_decode</a></li>
<li><a href="/functions/quoted_printable_encode">quoted_printable_encode</a></li>
<li><a href="/functions/quotemeta">quotemeta</a></li>
<li><a href="/functions/rtrim">rtrim</a></li>
<li><a href="/functions/setlocale">setlocale</a></li>
<li><a href="/functions/sha1">sha1</a></li>
<li><a href="/functions/sha1_file">sha1_file</a></li>
<li><a href="/functions/similar_text">similar_text</a></li>
<li><a href="/functions/soundex">soundex</a></li>
<li><a href="/functions/split">split</a></li>
<li><a href="/functions/sprintf">sprintf</a></li>
<li><a href="/functions/sscanf">sscanf</a></li>
<li><a href="/functions/str_getcsv">str_getcsv</a></li>
<li><a href="/functions/str_ireplace">str_ireplace</a></li>
<li><a href="/functions/str_pad">str_pad</a></li>
<li><a href="/functions/str_repeat">str_repeat</a></li>
<li><a href="/functions/str_replace">str_replace</a></li>
<li><a href="/functions/str_rot13">str_rot13</a></li>
<li><a href="/functions/str_shuffle">str_shuffle</a></li>
<li><a href="/functions/str_split">str_split</a></li>
<li><a href="/functions/str_word_count">str_word_count</a></li>
<li><a href="/functions/strcasecmp">strcasecmp</a></li>
<li><a href="/functions/strchr">strchr</a></li>
<li><a href="/functions/strcmp">strcmp</a></li>
<li><a href="/functions/strcoll">strcoll</a></li>
<li><a href="/functions/strcspn">strcspn</a></li>
<li><a href="/functions/strip_tags">strip_tags</a></li>
<li><a href="/functions/stripos">stripos</a></li>
<li><a href="/functions/stripslashes">stripslashes</a></li>
<li><a href="/functions/stristr">stristr</a></li>
<li><a href="/functions/strlen">strlen</a></li>
<li><a href="/functions/strnatcasecmp">strnatcasecmp</a></li>
<li><a href="/functions/strnatcmp">strnatcmp</a></li>
<li><a href="/functions/strncasecmp">strncasecmp</a></li>
<li><a href="/functions/strncmp">strncmp</a></li>
<li><a href="/functions/strpbrk">strpbrk</a></li>
<li><a href="/functions/strpos">strpos</a></li>
<li><a href="/functions/strrchr">strrchr</a></li>
<li><a href="/functions/strrev">strrev</a></li>
<li><a href="/functions/strripos">strripos</a></li>
<li><a href="/functions/strrpos">strrpos</a></li>
<li><a href="/functions/strspn">strspn</a></li>
<li><a href="/functions/strstr">strstr</a></li>
<li><a href="/functions/strtok">strtok</a></li>
<li><a href="/functions/strtolower">strtolower</a></li>
<li><a href="/functions/strtoupper">strtoupper</a></li>
<li><a href="/functions/strtr">strtr</a></li>
<li><a href="/functions/substr">substr</a></li>
<li><a href="/functions/substr_compare">substr_compare</a></li>
<li><a href="/functions/substr_count">substr_count</a></li>
<li><a href="/functions/substr_replace">substr_replace</a></li>
<li><a href="/functions/trim">trim</a></li>
<li><a href="/functions/ucfirst">ucfirst</a></li>
<li><a href="/functions/ucwords">ucwords</a></li>
<li><a href="/functions/vprintf">vprintf</a></li>
<li><a href="/functions/vsprintf">vsprintf</a></li>
<li><a href="/functions/wordwrap">wordwrap</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
<a href="http://rene-springmann.de" rel="nofollow">Rene Springmann</a>
</strong>
on 2012-10-04 13:00:24 <br />
Thank u for that great function
<hr />


<strong>
ee
</strong>
on 2012-09-24 09:31:54 <br />
กดหกดหกด
ำำำำ
แแแแแแ
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2012-06-16 07:09:49 <br />
@Alvin, Thomas: It is ok in Git, but not in the display. Click &quot;raw js source&quot; to see. However, I also changed the source to split up the line break so that it will hopefully display correctly once the cache of the site is reset.
<hr />


<strong>
Alvin
</strong>
on 2012-05-11 08:05:05 <br />
<pre><code>
var breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '' : '&lt;br&gt;';
</code></pre>

that line is wrong, it should be:

<pre><code>
var breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '&lt;br /&gt;' : '&lt;br&gt;';
</code></pre>
<hr />


<strong>
Thomas
</strong>
on 2012-01-04 19:15:13 <br />
The breakTag variable doesn&#8217;t display correctly.
<hr />


<strong>
<a href="http://tomakefast.com" rel="nofollow">PJ Brunet</a>
</strong>
on 2011-09-06 08:19:31 <br />
Thanks for the clarification, indeed I was looking at the syntax highlighter version.  

I&#8217;m about to try this function to workaround some .innerHTML issue I&#8217;m having.  
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2011-09-05 08:59:37 <br />
@PJ Brunet: Just avoid the 2nd argument (or pass true) (it&#8217;s not showing in the syntax highlighter, but it&#8217;s there if you look at the source). That&#8217;s the PHP way too, which we try to stick to here&#8230;
<hr />


<strong>
<a href="http://tomakefast.com" rel="nofollow">PJ Brunet</a>
</strong>
on 2011-09-04 11:00:13 <br />
I&#8217;m voting for <pre><code>&lt;br /&gt;</code></pre> vs. &quot;br&quot; 
<hr />


<strong>
Dj
</strong>
on 2011-07-28 04:29:02 <br />
Why not use first regex instead the second one? (without [^&gt;\r\n]?)
<pre><code>
return (str + '').replace(/(\r\n|\n\r|\r|\n)/g, breakTag + '$1');
</code></pre>
<pre><code>
return (str + '').replace(/([^&gt;\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1' + breakTag + '$2');
</code></pre>
<hr />


<strong>
Atttze
</strong>
on 2010-02-17 16:34:35 <br />
In Firefox (maybe more browsers) the &lt;br /&gt; in the code block above at line 22 is &#8216;hidden&#8217;&#8230;
<hr />


<strong>
Atttze
</strong>
on 2010-02-17 16:32:32 <br />
According to the PHP docs it should be:

<pre><code>
var breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '&lt;br /&gt;' : '&lt;br&gt;';
</code></pre>

Not:
<pre><code>
var breakTag = (is_xhtml || typeof is_xhtml === 'undefined') ? '' : '&lt;br&gt;';
</code></pre>
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-11-14 00:14:01 <br />
@Maximusya: Good catch&#8211;fixed in http://github.com/kvz/phpjs/commit/cc8835a98b175ad7038fcd64c85936f3bea8bdbb
<hr />


<strong>
Maximusya
</strong>
on 2009-11-13 15:49:44 <br />
Taking into account different newline combinations (\r\n, \r, \n), function should return
<pre><code>
return (str + '').replace(/([^&gt;\r\n]?)(\r\n|\n\r|\r|\n)/g, '$1'+ breakTag +'$2');
</code></pre>
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2009-01-14 12:03:30 <br />
@ John Peterson: Of course: that&#8217;s not at all like PHP. And that&#8217;s what we&#8217;re trying to recreate here: So the main version should be as is it right now.

However. Just like there&#8217;s a namespaced version of PHP.JS, I think it should be possible for us to generate prototype versions with the compiler. 

Currently this is a low priority for me and I would first like to create a public interface to the compiler on the phpjs.org site.

But I will keep this in mind as a future feature!
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-14 10:00:20 <br />
I should add the extra qualification that overloading the Object or Array prototype would probably be quite objectionable to many and need some serious revising of the PHP-JS functions (which I&#8217;m thinking should probably be revised regardless) to check for hasOwnProperty in each iterating for loop.
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-14 09:53:21 <br />
HI John,

I think concerns on this range from &amp;quot;What happens if a standard version gets implemented later?&amp;quot; to &amp;quot;Will this interfere with other implementations added to the prototype (as a kind of &amp;quot;global&amp;quot; problem?&amp;quot;), etc.. However, I personally think this could be very convenient for those willing to take the risk (or who reset the prototype after their code is done with it). 

Maybe when we get the string functions done ( ;) ), we can make one version of the PHP-JS package which adds to the prototype (also for Array, Object, Number, or maybe Function or Boolean if you can think of a reason!), as I&#8217;m hoping we can see a configurable version made at some point (as an independent project, if not through Kevin&#8217;s official version).
<hr />


<strong>
<a href="http://www.phpontrax.com" rel="nofollow">John Peterson</a>
</strong>
on 2009-01-14 07:56:20 <br />
Why not just do this so much simplier&#8230;

String.prototype.nl2br = function() {  
    var breakTag = &#8216;&amp;lt;br /&amp;gt;&#8217;;    
    return (this + &#8221;).replace(/([^&amp;gt;]?)\n/g, &#8216;$1&#8217;+ breakTag +&#8217;\n&#8217;);  
}

then you can just do:

mystring.nl2br()
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-10-13 11:25:57 <br />
@ Atli ÃžÃ³r: That&#8217;s a Great contribution Atli ÃžÃ³r. I wish I could give your more credit, than the current system can give you. Thanks man.
<hr />


<strong>
<a href="atli.advefir.com" rel="nofollow">Atli Þór</a>
</strong>
on 2008-10-10 18:44:23 <br />
Not sure why my last post got messed up like that.
If it was bad formatting on my part I apologize.
<hr />


<strong>
<a href="http://atli.advefir.com" rel="nofollow">Atli Þór</a>
</strong>
on 2008-10-10 18:39:20 <br />
Hi.

There seems to be a minor flaw in the function for strings that start with a line-breaks, or have multiple consecutive line-breaks.

Using this:
<pre><code>nl2br(&amp;quot;\nOne\nTwo\n\nThree\n&amp;quot;)</code></pre>
it leaves out the first new-line and replaces the two new-lines between &amp;quot;Two&amp;quot; and &amp;quot;Three&amp;quot; with a single break.

Making the regex non-greedy seems to fix this tho:
<pre><code>
return (str + '').replace(/([^&amp;gt;]?)\n/g, '$1&amp;lt;br /&amp;gt;\n');
</code></pre>

Additionally,  PHP 5.3 will accept a second parameter, indicating whether the break should be XHTML compliant or not.

This would allow for that as well:
<pre><code>
function nl2br( str, is_xhtml ) {
    breakTag = &amp;quot;&amp;lt;br /&amp;gt;&amp;quot;;
    if(typeof is_xhtml == &amp;quot;boolean&amp;quot; || is_xhtml == false) {
        breakTag = &amp;quot;&amp;lt;br&amp;gt;&amp;quot;;
    }
    return (str + '').replace(/([^&amp;gt;]?)\n/g, '$1'+ breakTag +'\n');
}
</code></pre>
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-09-29 12:37:00 <br />
@ Onno Marsman: Nice :) Function has been updated according to your proposal!
<hr />


<strong>
Onno Marsman
</strong>
on 2008-09-26 13:39:59 <br />
lol, still no good. Kevin: you know what I mean. I&#8217;ve only added (str+&#8221;)
<hr />


<strong>
Onno marsman
</strong>
on 2008-09-26 13:37:35 <br />
I guess html is not escaped correctly, I meant:
<pre><code>
function nl2br( str ) {
    return (str+'').replace(/([^&amp;gt;])\n/g, '$1&amp;amp;lt;br /&amp;amp;gt;\n');
}
</code></pre>
<hr />


<strong>
Onno Marsman
</strong>
on 2008-09-26 13:33:57 <br />
To make sure it&#8217;s a string i.e. nl2br(6):

<pre><code>
function nl2br( str ) {
     return (str+'').replace(/([^&amp;gt;])\n/g, '$1&amp;lt;br /&amp;gt;\n');
}
</code></pre>
<hr />


<strong>
<a href="http://darussia.com" rel="nofollow">Music Russia</a>
</strong>
on 2008-09-08 03:10:20 <br />
Sorry, Kevin, that&#8217;s just my stupid mistake, i confused one var with another. I spend about 15 minutes until figured it out.

Here&#8217;s the part of my code and it 100% works now:

<pre><code>
var nfull = document.getElementById('full').value;
nfull = nfull.replace(/([^&amp;gt;])\\n/g, '$1&amp;lt;br /&amp;gt;');
document.getElementById('txtpr').innerHTML = nfull;
</code></pre>

Thank you for the hint!
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-09-08 00:22:17 <br />
@ Music Russia: Please be more specific, can you for example provide the code how you call it? And explain what breaks? Thanks a lot!
<hr />


<strong>
<a href="http://darussia.com" rel="nofollow">Music Russia</a>
</strong>
on 2008-09-06 21:28:33 <br />
Do not work in my case.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-05-21 12:57:12 <br />
@ Joshua: Thank you, we&#8217;re still working on a tool to customize &amp;amp; save your own php.js version, maybe that would be something for you then!
<hr />


<strong>
Joshua
</strong>
on 2008-05-21 11:13:42 <br />
Nice piece of js code, very usefull :) I&#8217;m not using the whole package but just little pieces of code, great work!
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-04-15 08:18:18 <br />
@ Philip Peterson: I&#8217;ve updated the function with your suggestions. Thank you!
<hr />


<strong>
Philip Peterson
</strong>
on 2008-04-15 02:41:13 <br />
There are a few inconsistencies here:

first off, the replacement text should be &amp;quot;&amp;lt;br /&amp;gt;\n&amp;quot; (with the space before the backslash in &amp;lt;br /&amp;gt; and including the newline).  Also, I don&#8217;t have time to do this, but you may want to check out how PHP handles \r\n and \r in this function, as it may be useful to implement support for if the PHP function does it.
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/nl2br/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/nl2br/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Kevin van Zonneveld -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/nl2br/index.html';
        var disqus_url = 'http://phpjs.org/functions/nl2br/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
