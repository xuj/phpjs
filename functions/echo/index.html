
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript echo function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript echo function A JavaScript equivalent of PHP&#8217;s echo strings/echo.js raw on github 1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/echo/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <a target="_blank" href="https://github.com/kvz/phpjs">
    <img id="fork-us" style="position: fixed; z-index: 99; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub">
  </a>
  <header role="banner"><hgroup>
  <div id="logo">
    <h1><a href="/">php.js</a></h1>
  	<div class="clear"></div>
  </div>

  
  
    <h2>Learn how to do it in JavaScript. Explore boundaries porting languages. Use functions that turn out to be useful.</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
  <li><a target="_blank" href="https://github.com/kvz/phpjs/wiki/_pages">Wiki</a></li>
  <li><a target="_blank"  href="http://twitter.com/phpjs">@phpjs</a></li>
  <li><a target="_blank"  href="http://identi.ca/brettz9">@brettz9</a></li>
  <li><a target="_blank"  href="http://twitter.com/kvz">@kvz</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript echo function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s echo</p>

<figure class='code'><figcaption><span>strings/echo.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/strings/echo.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
<span class='line-number'>54</span>
<span class='line-number'>55</span>
<span class='line-number'>56</span>
<span class='line-number'>57</span>
<span class='line-number'>58</span>
<span class='line-number'>59</span>
<span class='line-number'>60</span>
<span class='line-number'>61</span>
<span class='line-number'>62</span>
<span class='line-number'>63</span>
<span class='line-number'>64</span>
<span class='line-number'>65</span>
<span class='line-number'>66</span>
<span class='line-number'>67</span>
<span class='line-number'>68</span>
<span class='line-number'>69</span>
<span class='line-number'>70</span>
<span class='line-number'>71</span>
<span class='line-number'>72</span>
<span class='line-number'>73</span>
<span class='line-number'>74</span>
<span class='line-number'>75</span>
<span class='line-number'>76</span>
<span class='line-number'>77</span>
<span class='line-number'>78</span>
<span class='line-number'>79</span>
<span class='line-number'>80</span>
<span class='line-number'>81</span>
<span class='line-number'>82</span>
<span class='line-number'>83</span>
<span class='line-number'>84</span>
<span class='line-number'>85</span>
<span class='line-number'>86</span>
<span class='line-number'>87</span>
<span class='line-number'>88</span>
<span class='line-number'>89</span>
<span class='line-number'>90</span>
<span class='line-number'>91</span>
<span class='line-number'>92</span>
<span class='line-number'>93</span>
<span class='line-number'>94</span>
<span class='line-number'>95</span>
<span class='line-number'>96</span>
<span class='line-number'>97</span>
<span class='line-number'>98</span>
<span class='line-number'>99</span>
<span class='line-number'>100</span>
<span class='line-number'>101</span>
<span class='line-number'>102</span>
<span class='line-number'>103</span>
<span class='line-number'>104</span>
<span class='line-number'>105</span>
<span class='line-number'>106</span>
<span class='line-number'>107</span>
<span class='line-number'>108</span>
<span class='line-number'>109</span>
<span class='line-number'>110</span>
<span class='line-number'>111</span>
<span class='line-number'>112</span>
<span class='line-number'>113</span>
<span class='line-number'>114</span>
<span class='line-number'>115</span>
<span class='line-number'>116</span>
<span class='line-number'>117</span>
<span class='line-number'>118</span>
<span class='line-number'>119</span>
<span class='line-number'>120</span>
<span class='line-number'>121</span>
<span class='line-number'>122</span>
<span class='line-number'>123</span>
<span class='line-number'>124</span>
<span class='line-number'>125</span>
<span class='line-number'>126</span>
<span class='line-number'>127</span>
<span class='line-number'>128</span>
<span class='line-number'>129</span>
<span class='line-number'>130</span>
<span class='line-number'>131</span>
<span class='line-number'>132</span>
<span class='line-number'>133</span>
<span class='line-number'>134</span>
<span class='line-number'>135</span>
<span class='line-number'>136</span>
<span class='line-number'>137</span>
<span class='line-number'>138</span>
<span class='line-number'>139</span>
<span class='line-number'>140</span>
<span class='line-number'>141</span>
<span class='line-number'>142</span>
<span class='line-number'>143</span>
<span class='line-number'>144</span>
<span class='line-number'>145</span>
<span class='line-number'>146</span>
<span class='line-number'>147</span>
<span class='line-number'>148</span>
<span class='line-number'>149</span>
<span class='line-number'>150</span>
<span class='line-number'>151</span>
<span class='line-number'>152</span>
<span class='line-number'>153</span>
<span class='line-number'>154</span>
<span class='line-number'>155</span>
<span class='line-number'>156</span>
<span class='line-number'>157</span>
<span class='line-number'>158</span>
<span class='line-number'>159</span>
<span class='line-number'>160</span>
<span class='line-number'>161</span>
<span class='line-number'>162</span>
<span class='line-number'>163</span>
<span class='line-number'>164</span>
<span class='line-number'>165</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">echo</span> <span class="p">()</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// http://kevin.vanzonneveld.net</span>
</span><span class='line'>  <span class="c1">// +   original by: Philip Peterson</span>
</span><span class='line'>  <span class="c1">// +   improved by: echo is bad</span>
</span><span class='line'>  <span class="c1">// +   improved by: Nate</span>
</span><span class='line'>  <span class="c1">// +    revised by: Der Simon (http://innerdom.sourceforge.net/)</span>
</span><span class='line'>  <span class="c1">// +   improved by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Eugene Bulkin (http://doubleaw.com/)</span>
</span><span class='line'>  <span class="c1">// +   input by: JB</span>
</span><span class='line'>  <span class="c1">// +   improved by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: EdorFaus</span>
</span><span class='line'>  <span class="c1">// +   improved by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// %        note 1: If browsers start to support DOM Level 3 Load and Save (parsing/serializing),</span>
</span><span class='line'>  <span class="c1">// %        note 1: we wouldn&#39;t need any such long code (even most of the code below). See</span>
</span><span class='line'>  <span class="c1">// %        note 1: link below for a cross-browser implementation in JavaScript. HTML5 might</span>
</span><span class='line'>  <span class="c1">// %        note 1: possibly support DOMParser, but that is not presently a standard.</span>
</span><span class='line'>  <span class="c1">// %        note 2: Although innerHTML is widely used and may become standard as of HTML5, it is also not ideal for</span>
</span><span class='line'>  <span class="c1">// %        note 2: use with a temporary holder before appending to the DOM (as is our last resort below),</span>
</span><span class='line'>  <span class="c1">// %        note 2: since it may not work in an XML context</span>
</span><span class='line'>  <span class="c1">// %        note 3: Using innerHTML to directly add to the BODY is very dangerous because it will</span>
</span><span class='line'>  <span class="c1">// %        note 3: break all pre-existing references to HTMLElements.</span>
</span><span class='line'>  <span class="c1">// *     example 1: echo(&#39;&lt;div&gt;&lt;p&gt;abc&lt;/p&gt;&lt;p&gt;abc&lt;/p&gt;&lt;/div&gt;&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 1: undefined</span>
</span><span class='line'>  <span class="c1">// Fix: This function really needs to allow non-XHTML input (unless in true XHTML mode) as in jQuery</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">arg</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">argc</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">.</span><span class="nx">length</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">argv</span> <span class="o">=</span> <span class="nx">arguments</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">holder</span><span class="p">,</span> <span class="nx">win</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nb">window</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">d</span> <span class="o">=</span> <span class="nx">win</span><span class="p">.</span><span class="nb">document</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">ns_xhtml</span> <span class="o">=</span> <span class="s1">&#39;http://www.w3.org/1999/xhtml&#39;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">ns_xul</span> <span class="o">=</span> <span class="s1">&#39;http://www.mozilla.org/keymaster/gatekeeper/there.is.only.xul&#39;</span><span class="p">;</span> <span class="c1">// If we&#39;re in a XUL context</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">stringToDOM</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">str</span><span class="p">,</span> <span class="nx">parent</span><span class="p">,</span> <span class="nx">ns</span><span class="p">,</span> <span class="nx">container</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">extraNSs</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">ns</span> <span class="o">===</span> <span class="nx">ns_xul</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">extraNSs</span> <span class="o">=</span> <span class="s1">&#39; xmlns:html=&quot;&#39;</span> <span class="o">+</span> <span class="nx">ns_xhtml</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">stringContainer</span> <span class="o">=</span> <span class="s1">&#39;&lt;&#39;</span> <span class="o">+</span> <span class="nx">container</span> <span class="o">+</span> <span class="s1">&#39; xmlns=&quot;&#39;</span> <span class="o">+</span> <span class="nx">ns</span> <span class="o">+</span> <span class="s1">&#39;&quot;&#39;</span> <span class="o">+</span> <span class="nx">extraNSs</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span> <span class="o">+</span> <span class="nx">str</span> <span class="o">+</span> <span class="s1">&#39;&lt;/&#39;</span> <span class="o">+</span> <span class="nx">container</span> <span class="o">+</span> <span class="s1">&#39;&gt;&#39;</span><span class="p">;</span>
</span><span class='line'>    <span class="kd">var</span> <span class="nx">dils</span> <span class="o">=</span> <span class="nx">win</span><span class="p">.</span><span class="nx">DOMImplementationLS</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">dp</span> <span class="o">=</span> <span class="nx">win</span><span class="p">.</span><span class="nx">DOMParser</span><span class="p">,</span>
</span><span class='line'>      <span class="nx">ax</span> <span class="o">=</span> <span class="nx">win</span><span class="p">.</span><span class="nx">ActiveXObject</span><span class="p">;</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">dils</span> <span class="o">&amp;&amp;</span> <span class="nx">dils</span><span class="p">.</span><span class="nx">createLSInput</span> <span class="o">&amp;&amp;</span> <span class="nx">dils</span><span class="p">.</span><span class="nx">createLSParser</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// Follows the DOM 3 Load and Save standard, but not</span>
</span><span class='line'>      <span class="c1">// implemented in browsers at present; HTML5 is to standardize on innerHTML, but not for XML (though</span>
</span><span class='line'>      <span class="c1">// possibly will also standardize with DOMParser); in the meantime, to ensure fullest browser support, could</span>
</span><span class='line'>      <span class="c1">// attach http://svn2.assembla.com/svn/brettz9/DOMToString/DOM3.js (see http://svn2.assembla.com/svn/brettz9/DOMToString/DOM3.xhtml for a simple test file)</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">lsInput</span> <span class="o">=</span> <span class="nx">dils</span><span class="p">.</span><span class="nx">createLSInput</span><span class="p">();</span>
</span><span class='line'>      <span class="c1">// If we&#39;re in XHTML, we&#39;ll try to allow the XHTML namespace to be available by default</span>
</span><span class='line'>      <span class="nx">lsInput</span><span class="p">.</span><span class="nx">stringData</span> <span class="o">=</span> <span class="nx">stringContainer</span><span class="p">;</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">lsParser</span> <span class="o">=</span> <span class="nx">dils</span><span class="p">.</span><span class="nx">createLSParser</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="kc">null</span><span class="p">);</span> <span class="c1">// synchronous, no schema type</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">lsParser</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">lsInput</span><span class="p">).</span><span class="nx">firstChild</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">dp</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// If we&#39;re in XHTML, we&#39;ll try to allow the XHTML namespace to be available by default</span>
</span><span class='line'>      <span class="k">try</span> <span class="p">{</span>
</span><span class='line'>        <span class="kd">var</span> <span class="nx">fc</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">dp</span><span class="p">().</span><span class="nx">parseFromString</span><span class="p">(</span><span class="nx">stringContainer</span><span class="p">,</span> <span class="s1">&#39;text/xml&#39;</span><span class="p">);</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">fc</span> <span class="o">&amp;&amp;</span> <span class="nx">fc</span><span class="p">.</span><span class="nx">documentElement</span> <span class="o">&amp;&amp;</span> <span class="nx">fc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">localName</span> <span class="o">!==</span> <span class="s1">&#39;parsererror&#39;</span> <span class="o">&amp;&amp;</span> <span class="nx">fc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">namespaceURI</span> <span class="o">!==</span> <span class="s1">&#39;http://www.mozilla.org/newlayout/xml/parsererror.xml&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="k">return</span> <span class="nx">fc</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">;</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>        <span class="c1">// If there&#39;s a parsing error, we just continue on</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">catch</span> <span class="p">(</span><span class="nx">e</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="c1">// If there&#39;s a parsing error, we just continue on</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">ax</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// We don&#39;t bother with a holder in Explorer as it doesn&#39;t support namespaces</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">axo</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">ax</span><span class="p">(</span><span class="s1">&#39;MSXML2.DOMDocument&#39;</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">axo</span><span class="p">.</span><span class="nx">loadXML</span><span class="p">(</span><span class="nx">str</span><span class="p">);</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">axo</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="cm">/*else if (win.XMLHttpRequest) { // Supposed to work in older Safari</span>
</span><span class='line'><span class="cm">      var req = new win.XMLHttpRequest;</span>
</span><span class='line'><span class="cm">      req.open(&#39;GET&#39;, &#39;data:application/xml;charset=utf-8,&#39;+encodeURIComponent(str), false);</span>
</span><span class='line'><span class="cm">      if (req.overrideMimeType) {</span>
</span><span class='line'><span class="cm">        req.overrideMimeType(&#39;application/xml&#39;);</span>
</span><span class='line'><span class="cm">      }</span>
</span><span class='line'><span class="cm">      req.send(null);</span>
</span><span class='line'><span class="cm">      return req.responseXML;</span>
</span><span class='line'><span class="cm">    }*/</span>
</span><span class='line'>    <span class="c1">// Document fragment did not work with innerHTML, so we create a temporary element holder</span>
</span><span class='line'>    <span class="c1">// If we&#39;re in XHTML, we&#39;ll try to allow the XHTML namespace to be available by default</span>
</span><span class='line'>    <span class="c1">//if (d.createElementNS &amp;&amp; (d.contentType &amp;&amp; d.contentType !== &#39;text/html&#39;)) { // Don&#39;t create namespaced elements if we&#39;re being served as HTML (currently only Mozilla supports this detection in true XHTML-supporting browsers, but Safari and Opera should work with the above DOMParser anyways, and IE doesn&#39;t support createElementNS anyways)</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">createElementNS</span> <span class="o">&amp;&amp;</span> <span class="c1">// Browser supports the method</span>
</span><span class='line'>    <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">namespaceURI</span> <span class="o">||</span> <span class="c1">// We can use if the document is using a namespace</span>
</span><span class='line'>    <span class="nx">d</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">()</span> <span class="o">!==</span> <span class="s1">&#39;html&#39;</span> <span class="o">||</span> <span class="c1">// We know it&#39;s not HTML4 or less, if the tag is not HTML (even if the root namespace is null)</span>
</span><span class='line'>    <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">contentType</span> <span class="o">&amp;&amp;</span> <span class="nx">d</span><span class="p">.</span><span class="nx">contentType</span> <span class="o">!==</span> <span class="s1">&#39;text/html&#39;</span><span class="p">)</span> <span class="c1">// We know it&#39;s not regular HTML4 or less if this is Mozilla (only browser supporting the attribute) and the content type is something other than text/html; other HTML5 roots (like svg) still have a namespace</span>
</span><span class='line'>    <span class="p">))</span> <span class="p">{</span> <span class="c1">// Don&#39;t create namespaced elements if we&#39;re being served as HTML (currently only Mozilla supports this detection in true XHTML-supporting browsers, but Safari and Opera should work with the above DOMParser anyways, and IE doesn&#39;t support createElementNS anyways); last test is for the sake of being in a pure XML document</span>
</span><span class='line'>      <span class="nx">holder</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createElementNS</span><span class="p">(</span><span class="nx">ns</span><span class="p">,</span> <span class="nx">container</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">holder</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">container</span><span class="p">);</span> <span class="c1">// Document fragment did not work with innerHTML</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="nx">holder</span><span class="p">.</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="nx">str</span><span class="p">;</span>
</span><span class='line'>    <span class="k">while</span> <span class="p">(</span><span class="nx">holder</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">parent</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">holder</span><span class="p">.</span><span class="nx">firstChild</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>    <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
</span><span class='line'>    <span class="c1">// throw &#39;Your browser does not support DOM parsing as required by echo()&#39;;</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">ieFix</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">node</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeType</span> <span class="o">===</span> <span class="mi">1</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">newNode</span> <span class="o">=</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeName</span><span class="p">);</span>
</span><span class='line'>      <span class="kd">var</span> <span class="nx">i</span><span class="p">,</span> <span class="nx">len</span><span class="p">;</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">newNode</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">,</span> <span class="nx">node</span><span class="p">.</span><span class="nx">getAttribute</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">attributes</span><span class="p">[</span><span class="nx">i</span><span class="p">].</span><span class="nx">nodeName</span><span class="p">));</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span> <span class="o">&amp;&amp;</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="nx">len</span> <span class="o">=</span> <span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">.</span><span class="nx">length</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">len</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>          <span class="nx">newNode</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">ieFix</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">childNodes</span><span class="p">[</span><span class="nx">i</span><span class="p">]));</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">newNode</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">d</span><span class="p">.</span><span class="nx">createTextNode</span><span class="p">(</span><span class="nx">node</span><span class="p">.</span><span class="nx">nodeValue</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">replacer</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">(</span><span class="nx">s</span><span class="p">,</span> <span class="nx">m1</span><span class="p">,</span> <span class="nx">m2</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="c1">// We assume for now that embedded variables do not have dollar sign; to add a dollar sign, you currently must use {$$var} (We might change this, however.)</span>
</span><span class='line'>    <span class="c1">// Doesn&#39;t cover all cases yet: see http://php.net/manual/en/language.types.string.php#language.types.string.syntax.double</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">m1</span> <span class="o">!==</span> <span class="s1">&#39;\\&#39;</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">m1</span> <span class="o">+</span> <span class="nb">eval</span><span class="p">(</span><span class="nx">m2</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">return</span> <span class="nx">s</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">};</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">this</span><span class="p">.</span><span class="nx">php_js</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">php_js</span> <span class="o">||</span> <span class="p">{};</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">phpjs</span> <span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">php_js</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">ini</span> <span class="o">=</span> <span class="nx">phpjs</span><span class="p">.</span><span class="nx">ini</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">obs</span> <span class="o">=</span> <span class="nx">phpjs</span><span class="p">.</span><span class="nx">obs</span><span class="p">;</span>
</span><span class='line'>  <span class="k">for</span> <span class="p">(</span><span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">argc</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">arg</span> <span class="o">=</span> <span class="nx">argv</span><span class="p">[</span><span class="nx">i</span><span class="p">];</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">ini</span> <span class="o">&amp;&amp;</span> <span class="nx">ini</span><span class="p">[</span><span class="s1">&#39;phpjs.echo_embedded_vars&#39;</span><span class="p">])</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">arg</span> <span class="o">=</span> <span class="nx">arg</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/(.?)\{?\$(\w*?\}|\w*)/g</span><span class="p">,</span> <span class="nx">replacer</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">phpjs</span><span class="p">.</span><span class="nx">flushing</span> <span class="o">&amp;&amp;</span> <span class="nx">obs</span> <span class="o">&amp;&amp;</span> <span class="nx">obs</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// If flushing we output, but otherwise presence of a buffer means caching output</span>
</span><span class='line'>      <span class="nx">obs</span><span class="p">[</span><span class="nx">obs</span><span class="p">.</span><span class="nx">length</span> <span class="o">-</span> <span class="mi">1</span><span class="p">].</span><span class="nx">buffer</span> <span class="o">+=</span> <span class="nx">arg</span><span class="p">;</span>
</span><span class='line'>      <span class="k">continue</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="k">if</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">body</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>        <span class="k">if</span> <span class="p">(</span><span class="nx">win</span><span class="p">.</span><span class="nx">navigator</span><span class="p">.</span><span class="nx">appName</span> <span class="o">===</span> <span class="s1">&#39;Microsoft Internet Explorer&#39;</span><span class="p">)</span> <span class="p">{</span> <span class="c1">// We unfortunately cannot use feature detection, since this is an IE bug with cloneNode nodes being appended</span>
</span><span class='line'>          <span class="nx">d</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">stringToDOM</span><span class="p">(</span><span class="nx">ieFix</span><span class="p">(</span><span class="nx">arg</span><span class="p">)));</span>
</span><span class='line'>        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>          <span class="kd">var</span> <span class="nx">unappendedLeft</span> <span class="o">=</span> <span class="nx">stringToDOM</span><span class="p">(</span><span class="nx">arg</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">body</span><span class="p">,</span> <span class="nx">ns_xhtml</span><span class="p">,</span> <span class="s1">&#39;div&#39;</span><span class="p">).</span><span class="nx">cloneNode</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span> <span class="c1">// We will not actually append the div tag (just using for providing XHTML namespace by default)</span>
</span><span class='line'>          <span class="k">if</span> <span class="p">(</span><span class="nx">unappendedLeft</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>            <span class="nx">d</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">unappendedLeft</span><span class="p">);</span>
</span><span class='line'>          <span class="p">}</span>
</span><span class='line'>        <span class="p">}</span>
</span><span class='line'>      <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>        <span class="nx">d</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">stringToDOM</span><span class="p">(</span><span class="nx">arg</span><span class="p">,</span> <span class="nx">d</span><span class="p">.</span><span class="nx">documentElement</span><span class="p">,</span> <span class="nx">ns_xul</span><span class="p">,</span> <span class="s1">&#39;description&#39;</span><span class="p">));</span> <span class="c1">// We will not actually append the description tag (just using for providing XUL namespace by default)</span>
</span><span class='line'>      <span class="p">}</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">d</span><span class="p">.</span><span class="nx">write</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">d</span><span class="p">.</span><span class="nx">write</span><span class="p">(</span><span class="nx">arg</span><span class="p">);</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'><span class="cm">/* else { // This could recurse if we ever add print!</span>
</span><span class='line'><span class="cm">      print(arg);</span>
</span><span class='line'><span class="cm">    }*/</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/strings/echo.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/strings/echo.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">echo</span><span class="p">(</span><span class="s1">&#39;&lt;div&gt;&lt;p&gt;abc&lt;/p&gt;&lt;p&gt;abc&lt;/p&gt;&lt;/div&gt;&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kc">undefined</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the strings extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/addcslashes">addcslashes</a></li>
<li><a href="/functions/addslashes">addslashes</a></li>
<li><a href="/functions/bin2hex">bin2hex</a></li>
<li><a href="/functions/chop">chop</a></li>
<li><a href="/functions/chr">chr</a></li>
<li><a href="/functions/chunk_split">chunk_split</a></li>
<li><a href="/functions/convert_cyr_string">convert_cyr_string</a></li>
<li><a href="/functions/convert_uuencode">convert_uuencode</a></li>
<li><a href="/functions/count_chars">count_chars</a></li>
<li><a href="/functions/crc32">crc32</a></li>
<li><a href="/functions/echo">echo</a></li>
<li><a href="/functions/explode">explode</a></li>
<li><a href="/functions/get_html_translation_table">get_html_translation_table</a></li>
<li><a href="/functions/html_entity_decode">html_entity_decode</a></li>
<li><a href="/functions/htmlentities">htmlentities</a></li>
<li><a href="/functions/htmlspecialchars">htmlspecialchars</a></li>
<li><a href="/functions/htmlspecialchars_decode">htmlspecialchars_decode</a></li>
<li><a href="/functions/implode">implode</a></li>
<li><a href="/functions/join">join</a></li>
<li><a href="/functions/lcfirst">lcfirst</a></li>
<li><a href="/functions/levenshtein">levenshtein</a></li>
<li><a href="/functions/localeconv">localeconv</a></li>
<li><a href="/functions/ltrim">ltrim</a></li>
<li><a href="/functions/md5">md5</a></li>
<li><a href="/functions/md5_file">md5_file</a></li>
<li><a href="/functions/metaphone">metaphone</a></li>
<li><a href="/functions/money_format">money_format</a></li>
<li><a href="/functions/nl2br">nl2br</a></li>
<li><a href="/functions/nl_langinfo">nl_langinfo</a></li>
<li><a href="/functions/number_format">number_format</a></li>
<li><a href="/functions/ord">ord</a></li>
<li><a href="/functions/parse_str">parse_str</a></li>
<li><a href="/functions/printf">printf</a></li>
<li><a href="/functions/quoted_printable_decode">quoted_printable_decode</a></li>
<li><a href="/functions/quoted_printable_encode">quoted_printable_encode</a></li>
<li><a href="/functions/quotemeta">quotemeta</a></li>
<li><a href="/functions/rtrim">rtrim</a></li>
<li><a href="/functions/setlocale">setlocale</a></li>
<li><a href="/functions/sha1">sha1</a></li>
<li><a href="/functions/sha1_file">sha1_file</a></li>
<li><a href="/functions/similar_text">similar_text</a></li>
<li><a href="/functions/soundex">soundex</a></li>
<li><a href="/functions/split">split</a></li>
<li><a href="/functions/sprintf">sprintf</a></li>
<li><a href="/functions/sscanf">sscanf</a></li>
<li><a href="/functions/str_getcsv">str_getcsv</a></li>
<li><a href="/functions/str_ireplace">str_ireplace</a></li>
<li><a href="/functions/str_pad">str_pad</a></li>
<li><a href="/functions/str_repeat">str_repeat</a></li>
<li><a href="/functions/str_replace">str_replace</a></li>
<li><a href="/functions/str_rot13">str_rot13</a></li>
<li><a href="/functions/str_shuffle">str_shuffle</a></li>
<li><a href="/functions/str_split">str_split</a></li>
<li><a href="/functions/str_word_count">str_word_count</a></li>
<li><a href="/functions/strcasecmp">strcasecmp</a></li>
<li><a href="/functions/strchr">strchr</a></li>
<li><a href="/functions/strcmp">strcmp</a></li>
<li><a href="/functions/strcoll">strcoll</a></li>
<li><a href="/functions/strcspn">strcspn</a></li>
<li><a href="/functions/strip_tags">strip_tags</a></li>
<li><a href="/functions/stripos">stripos</a></li>
<li><a href="/functions/stripslashes">stripslashes</a></li>
<li><a href="/functions/stristr">stristr</a></li>
<li><a href="/functions/strlen">strlen</a></li>
<li><a href="/functions/strnatcasecmp">strnatcasecmp</a></li>
<li><a href="/functions/strnatcmp">strnatcmp</a></li>
<li><a href="/functions/strncasecmp">strncasecmp</a></li>
<li><a href="/functions/strncmp">strncmp</a></li>
<li><a href="/functions/strpbrk">strpbrk</a></li>
<li><a href="/functions/strpos">strpos</a></li>
<li><a href="/functions/strrchr">strrchr</a></li>
<li><a href="/functions/strrev">strrev</a></li>
<li><a href="/functions/strripos">strripos</a></li>
<li><a href="/functions/strrpos">strrpos</a></li>
<li><a href="/functions/strspn">strspn</a></li>
<li><a href="/functions/strstr">strstr</a></li>
<li><a href="/functions/strtok">strtok</a></li>
<li><a href="/functions/strtolower">strtolower</a></li>
<li><a href="/functions/strtoupper">strtoupper</a></li>
<li><a href="/functions/strtr">strtr</a></li>
<li><a href="/functions/substr">substr</a></li>
<li><a href="/functions/substr_compare">substr_compare</a></li>
<li><a href="/functions/substr_count">substr_count</a></li>
<li><a href="/functions/substr_replace">substr_replace</a></li>
<li><a href="/functions/trim">trim</a></li>
<li><a href="/functions/ucfirst">ucfirst</a></li>
<li><a href="/functions/ucwords">ucwords</a></li>
<li><a href="/functions/vprintf">vprintf</a></li>
<li><a href="/functions/vsprintf">vsprintf</a></li>
<li><a href="/functions/wordwrap">wordwrap</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2010-12-27 05:50:40 <br />
@seingh: Yes, document.write() works all right (unless you are using XHTML served as application/xhtml+xml), but this function attempts to offer normal DOM construction (assuming well-formed XHTML) which can work in either environment.
<hr />


<strong>
seingh
</strong>
on 2010-12-25 13:19:41 <br />
i think that echo() is only document.write() &#8230;
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2010-10-29 02:31:43 <br />
@EdorFaus: Good catch (and bad mistake on my part, mitigated a bit by the catch thankfully). Fixed in Git (along with some JSLint/coding standards fixes).
<hr />


<strong>
EdorFaus
</strong>
on 2010-10-29 01:26:58 <br />
I think this code (lines 57-60) is not quite right:
<pre><code>
if (!fc || !fc.documentElement ||
  fc.documentElement.localName !== 'parsererror' ||
  fc.documentElement.namespaceURI !== 'http://www.mozilla.org/newlayout/xml/parsererror.xml') {
  return fc.documentElement.firstChild;
</code></pre>

Considering what&#8217;s in the block, and the last two tests, shouldn&#8217;t the or-s be and-s, and the two first tests be reversed, to avoid returning undefined? Like this:
<pre><code>
if (fc &amp;&amp; fc.documentElement &amp;&amp;
  fc.documentElement.localName !== 'parsererror' &amp;&amp;
  fc.documentElement.namespaceURI !== 'http://www.mozilla.org/newlayout/xml/parsererror.xml') {
  return fc.documentElement.firstChild;
</code></pre>
<hr />


<strong>
Cue
</strong>
on 2010-05-13 16:04:57 <br />
This throws an error in Firefox 3.6.3. Works fine in all other browsers.

<pre><code>stringToDOM(arg, d.body, ns_xhtml, &quot;div&quot;).cloneNode is not a function</code></pre>
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-05-30 10:22:22 <br />
JB, I adapted your idea as our last resort, since it may not work in an XML context. I also moved out the bulky code and added support for the common DOMParser or IE-specific parsing&#8211;for those who want full standards support, they can add the script referenced in the code to add DOM 3 Load and Save. The problem now though is that one must use the XHTML namespace since the script is giving a chance for the parsing to be done by DOMParser(), etc. for the sake of working with and in XML. We might make that code only execute if an ini is set, thus removing the need for a namespace.
<hr />


<strong>
JB
</strong>
on 2009-05-29 05:18:31 <br />
Couldn&#8217;t you just create a new node, innerHTML the code into it then move all of the children of the new node into body?
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-04-30 03:21:04 <br />
@Eugene, thanks for the catch! Fixed in SVN. (p.s. We&#8217;re hoping to catch such issues automatically in the future with JSLint)
<hr />


<strong>
<a href="http://doubleaw.com" rel="nofollow">Eugene Bulkin</a>
</strong>
on 2009-04-30 00:28:57 <br />
Lines 62 and 132 are missing semicolons after the bracket; as you are setting a var to a function, you must include them or when you pack the code it can trigger errors.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2009-01-25 13:41:24 <br />
@ Brett Zamir: Noted. I don&#8217;t mind big comments. Relevant info should be here, and people should know how to use ctrl+f :)
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-18 03:28:54 <br />
As far as output buffering, I plan to shortly discuss my thoughts on how this, as with other issues, can be solved without too much pain for maintenance with a global instead, but if not, being dependent on echo would be fine by me.  

By the way, maybe the function could also test 

if (document.body) {
    document.body.appendChild(stringToDOM(arg));
}
else {
    document.documentElement.appendChild(stringToDOM(arg));
}

to see if there IS a document.body, in case we are in an XML context (like XUL), and if not, append after the last element in the document.

As far as the speed, in my crude tests just now in JavaScript, there seems to be no difference in JavaScript between returning with null and not returning anything. But in PHP there is apparently a slight difference according to the FAQ linked from the PHP documentation: http://www.faqts.com/knowledge_base/view.phtml/aid/1/fid/40 , and the behavior of echo is not to return anything (while print returns 1), so I think there&#8217;s no reason to return null specifically (takes a little more space in the already big function!) :)

As far as implementing the DOM functions, you&#8217;re right, there is no place I know of, except serialize() if it handles DOM objects, and DOMDocument::saveXML, DOMDocument::loadXML . (speaking of the DOM in PHP (as in DOMDocument::validate), I&#8217;d LOVE to get XML validation in JS somehow).

But the note about the DOM functions was otherwise more just of an interesting aside (if you don&#8217;t mind my overloading the comments here!).
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2009-01-17 13:36:29 <br />
unfortunately, right now i cannot implement print as rhino already provides it. will have to change the testsuite later on.

out buffering is a great idea. we should first make all functions that print something rely on echo,
and have echo collect a buffer. i can see this working.

does that really effect the speed, yes?

notes removed.

I don&#8217;t see yet where else we we should implement those dom functions. I have to say I don&#8217;t work with that stuff on a daily basis.
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-17 03:14:38 <br />
Sorry, if you did apply my changes for an independent version of print(), this should be changed to also apply the fix for stringToDOM():

<pre><code>
    if (document.createDocumentFragment &amp;amp;&amp;amp; document.createTextNode &amp;amp;&amp;amp; document.appendChild) {
        stringToDOM(arg);
    }</code></pre>

to

<pre><code>
    if (document.createDocumentFragment &amp;amp;&amp;amp; document.createTextNode &amp;amp;&amp;amp; document.appendChild) {
        document.body.appendChild(stringToDOM(arg));
    }</code></pre>
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-17 03:11:03 <br />
One important thing first&#8230;The line

<pre><code>stringToDOM(arg);</code></pre>

needs to be changed to:

<pre><code>document.body.appendChild(stringToDOM(arg));</code></pre>

Now&#8230;print() would be the same with the following differences:

This line at the top:
<pre><code>var arg = '', argc = arguments.length, argv = arguments, i = 0;</code></pre>

can be entirely removed in print(). print() should also have &amp;quot;arg&amp;quot; added as an explicit function parameter (unless you want to merge the functions&#8211;see below).

To get the marginal speed difference with echo, you don&#8217;t even need the line &amp;quot;return null&amp;quot; because functions always return undefined when not specified (which is probably a little closer to the PHP behavior if we get picky).

The for loop at the end can be replaced with the following shorter version if you are making an independent version for print():

<pre><code>
    if (document.createDocumentFragment &amp;amp;&amp;amp; document.createTextNode &amp;amp;&amp;amp; document.appendChild) {
        stringToDOM(arg);
    } else if (document.write) {
        document.write(arg);
    }
    return 1;
</code></pre>

Note that if you did decide to have print() call echo() and just let its single argument cycle through the for loop one time, you&#8217;d have to still:
1) avoid potential recursion by avoiding the print(arg) call (as I did above for a dedicated version of print())
2) return 1 instead of not returning anything

Also, you can remove the notes to this function now (and for print()).

By the way, I realized that the stringToDOM() function can be stripped down a tiny bit more by changing substr() references to slice() (same behavior with one argument)&#8211;and substring() calls could be changed to slice() in cases where the 2nd argument would never be negative, though that would be harder to gauge without going through the code.

After going through the stringToDOM() code a little more, besides the shortening just mentioned, I realized that a little bit more could be done, such as allow namespaces on elements and attributes when parsing to DOM. I&#8217;m not sure though when I may have time to get to it (have some deadlines now), but I hope to get to it eventually. 

It would be cool if there could be some what we could specify where we wanted the echo to go (e.g., if we didn&#8217;t want it in the body).  You know, I think we should be able to actually implement the PHP output buffer functions by configuring a parameter (as in the global php_js) which allowed the output from such functions to be captured and aggregated (until flushed/cleaned) and then output later or assigned to a variable!

As an extended aside, another great thing about the stringToDOM() and DOMToString() functions is that they could be combined to make a standards-compliant version of the DOM level 3 Load-and-Save module for serialization and parsing (currently not supported in Firefox and probably other browsers). 

For example, using the skeleton code within the source at https://bugzilla.mozilla.org/attachment.cgi?id=333875 (for Mozilla bug https://bugzilla.mozilla.org/show_bug.cgi?id=155749 ), they could be used within the code for LSSerializer.prototype.writeToString and LSParser.prototype.parse .

Thus you could parse in any browser in a compliant fashion with something like this:

<pre><code>var lsInput = DOMImplementationLS.createLSInput().stringData = '&amp;lt;myXml/&amp;gt;';

var doc = DOMImplementationLS.createLSParser(1, null).parse(lsInput);
</code></pre>

and serialize in any browser with something like this:

<pre><code>
var ser = DOMImplementationLS.createLSSerializer();
var str = ser.writeToString(document);</code></pre>

Admittedly it might not be pretty, but it&#8217;s standard (and can easily be wrapped as with the current Firefox and IE equivalents).
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2009-01-16 23:11:51 <br />
@ der_simon &amp;amp; Brett Zamir: First of all, Der Simon Thank you so much for coming to us and offering your great code to our project. It seems we can put it to good use.

My main concern was that for such a little function, it would be a lot of code. There&#8217;s no room in PHP.JS for global dependencies so it would really have to be duplicated inside the functions. So a really bloated echo would be the result.

I&#8217;m okay with it now because:
- Brett you did a great job trimming it down the the essentials that are important to us.
- I have actually gotten some work done on the public compiler, which will enable people to optionally include echo in their package.

Never ceases to amaze me. The simplest functions sometimes need the biggest chunks of code ;)

Anyway, great effort both.

PS. Can we alias print to echo?
<hr />


<strong>
<a href="http://bahai-library.com" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-01-15 23:18:43 <br />
Since Kevin stated it might be possible to use innerDOM, I took it upon myself to check with Der Simon to see if we could release under MIT.

Although it is still somewhat large for the average PHP-JS function, with a few superficial tweaks to the already terse code (such as removing a couple document.all blocks), and by just using one of his functions (the only one needed by echo), we can get something as relatively small as this:

<pre><code>function stringToDOM(q){
    var d=document;
    function r(a){
    return a.replace(/\r/g,' ').replace(/\n/g,' ');
    }
    function s(a){
    return a.replace(/&amp;amp;amp;/g,'&amp;amp;').replace(/&amp;amp;gt;/g,'&amp;gt;').replace(/&amp;amp;lt;/g,'&amp;lt;').replace(/&amp;amp;nbsp;/g,' ').replace(/&amp;amp;quot;/g,'&amp;quot;');
    }
    function t(a){
    return a.replace(/ /g,'');
    }
    function u(a){
    var b,c,e,f,g,h,i;
    b=d.createDocumentFragment();
    c=a.indexOf(' ');
    if(c===-1){
        b.appendChild(d.createElement(a.toLowerCase()))
    }
    else{
        i=t(a.substring(0,c)).toLowerCase();
        a=a.substr(c+1);
        b.appendChild(d.createElement(i));
        while(a.length){
        e=a.indexOf('=');
        if(e&amp;gt;=0){
            f=t(a.substring(0,e)).toLowerCase();
            g=a.indexOf('&amp;quot;');
            a=a.substr(g+1);
            g=a.indexOf('&amp;quot;');
            h=s(a.substring(0,g));
            a=a.substr(g+2);
            b.lastChild.setAttribute(f,h)
          }else{
          break
          }
      }
      }
      return b
  }
  function v(a,b,c){
      var e,f;
      e=b;
      c=c.toLowerCase();
      f=e.indexOf('&amp;lt;/'+c+'&amp;gt;');
      a=a.concat(e.substring(0,f));
      e=e.substr(f);
      while(a.indexOf('&amp;lt;'+c)!=-1){
      a=a.substr(a.indexOf('&amp;lt;'+c));
      a=a.substr(a.indexOf('&amp;gt;')+1);
      e=e.substr(e.indexOf('&amp;gt;')+1);
      f=e.indexOf('&amp;lt;/'+c+'&amp;gt;');
      a=a.concat(e.substring(0,f));
      e=e.substr(f)
      }
      return b.length-e.length
  }
  function w(a){
      var b,c,e,f,g,h,i,j,k,l,m,n,o,p,q;
      b=d.createDocumentFragment();
      while(a&amp;amp;&amp;amp;a.length){
      c=a.indexOf('&amp;lt;');
      if(c===-1){
          a=s(a);
          b.appendChild(d.createTextNode(a));
          a=null
      }
      else if(c){
          q=s(a.substring(0,c));
          b.appendChild(d.createTextNode(q));
          a=a.substr(c)
      }
      else{
          e=a.indexOf('&amp;lt;!--');
          if(!e){
          f=a.indexOf('--&amp;gt;');
          g=a.substring(4,f);
          g=s(g);
          b.appendChild(d.createComment(g));
          a=a.substr(f+3)
          }
          else{
          h=a.indexOf('&amp;gt;');
          if(a.substring(h-1,h)==='/'){
              i=a.indexOf('/&amp;gt;');
              j=a.substring(1,i);
              b.appendChild(u(j));
              a=a.substr(i+2)
          }
          else{
              k=a.indexOf('&amp;gt;');
              l=a.substring(1,k);
              m=d.createDocumentFragment();
              m.appendChild(u(l));
              a=a.substr(k+1);
              n=a.substring(0,a.indexOf('&amp;lt;/'));
              a=a.substr(a.indexOf('&amp;lt;/'));
              if(n.indexOf('&amp;lt;')!=-1){
              o=m.lastChild.nodeName;
              p=v(n,a,o);
              n=n.concat(a.substring(0,p));
              a=a.substr(p)
              }
              a=a.substr(a.indexOf('&amp;gt;')+1);
              m.lastChild.appendChild(w(n));
              b.appendChild(m)
          }
          }
      }
      }
      return b
  }
  return w(q)
}</code></pre>

I suggest incorporating his useful and standards-compliant method (and also adding print() too), if you were still open to it&#8230; 

(Maybe it would be even more standards compliant if it checked for createElementNS support, but using the function in XUL still works ok for me)
<hr />


<strong>
<a href="http://simon-kuehn.de" rel="nofollow">der_simon</a>
</strong>
on 2009-01-15 20:44:37 <br />
Hi, 

im the author of the innerDOM-Script and I&#8217;m happy that anyone really cares about my few lines of code. I&#8217;m way out of the programming business, so I can only partly partitiate. 

What I couldn&#8217;t see from my point is: Whould it help to contribiute the innerDOM-Script to your project or not? The php.js page says: 

There&#8217;s no good place for a package like http://innerdom.sourceforge.net/

So if it would be helpful I&#8217;m willing to contribute my code. 

Regard from Germany

Der Simon
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-11-14 00:58:19 <br />
@ Nate: I believe it would upset a lot of peope if we were to use innerHTML (considering &amp;quot;echo is bad&amp;quot;&#8217;s comments). innerDOM seems to be a solution, but we can&#8217;t include it into php.js without changing php.js&#8217; nature. And to do that for only echo, would make inpracticle an understatement. We&#8217;ll have to think some more on the innerDOM thing I guess: maybe we could ask it&#8217;s author if we can just copy a portion of his code into this function directly. That would:
- work
- not change php.js&#8217; standalone-lyness
- make echo a big function ;)

Thank you very much for sharing your thoughts and code on this with us. For now, I&#8217;ve at least  comitted your changes.
<hr />


<strong>
Nate
</strong>
on 2008-11-13 16:16:35 <br />
There are a few problems with this function.

1. There is a misspelling.  The code
<pre><code>
            var txt = document.createTextNode(aarg);
</code></pre>
Should read
<pre><code>
            var txt = document.createTextNode(arg);
</code></pre>

2. After
<pre><code>
            docFragment.appendChild(txt); 
</code></pre>
you need the line
<pre><code>
            document.body.appendChild(docFragment);
</code></pre>

I tested it with Firefox, IE, Opera, and Chrome (via wine), and they all worked (on Linux).

3. Like Philip Peterson pointed out, createTextNode() converts HTML to text.  I still think that innerHTML() is better because it actually works (and it&#8217;s fast).  Though it might not be practical for this project, you could use the innerDOM script from http://innerdom.sourceforge.net/ to achieve the same effect as innerHTML() and adhere to &amp;quot;standards.&amp;quot;
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-11-03 11:08:12 <br />
@ Waldo Malqui Silva: Hi there! Good to have you back Waldo! I&#8217;ve changed all the _argos credits to Waldo Malqui Silva.

We track the &#8216;unported&#8217; functions in SVN, which can also be viewed here:
http://trac.plutonia.nl/projects/phpjs/browser/trunk/_unported

Everytime we create a new function it&#8217;s moved from ./_unported to ./functions

I&#8217;ll be looking forward to seeing some of your excellent work again.  And your english i fine btw ;) ciao!
<hr />


<strong>
waldo malqui silva
</strong>
on 2008-10-29 03:18:11 <br />
HI, Kevin I&#8217;m back from long tiime, I wanna know if is possible 2 things:

1.- Change mi nick (_argos) by my real name (Waldo Malqui Silva) :p
2.- If you have a TODO list of functions to port.


I&#8217;m happy to back and see more functions that in my last visit. I promise practice more my english :p

PD: I&#8217;m working in a customizable download for the project like mootools 1.11 (packages?) based on the PHP functions group :p
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-10-20 18:24:08 <br />
@ Philip Peterson: I&#8217;ve fixed the first issue, we still have to work on the second one.
<hr />


<strong>
Philip Peterson
</strong>
on 2008-10-18 03:15:22 <br />
Aggh, sorry to clog up the comments, but there&#8217;s also another problem: using createTextNode and then appending it like that converts all the special characters (e.g. tags) to HTML entities, thus reducing the usability of HTML formatting in echo().
<hr />


<strong>
Philip Peterson
</strong>
on 2008-10-18 03:07:05 <br />
Also, this is a very pressing issue.  In Firefox, at the line

<pre><code>
document.appendChild(elmt);
</code></pre>

the script breaks, because it should be (for Firefox at least)

<pre><code>
body.appendChild(elmt);
</code></pre>
<hr />


<strong>
Philip Peterson
</strong>
on 2008-10-14 22:43:47 <br />
From Ronsguide.com:

var docFragment = document.createDocumentFragment(); 
var txt = document.createTextNode(&amp;quot;my text node&amp;quot;); 
docFragment.appendChild(txt);

I guess probably something like that? (note that I am not &amp;quot;echo is bad&amp;quot;.)

Perhaps there should be an alias print() which would take one argument?  It may also be useful to handle \b things (I think php does this, but I&#8217;m not sure), which could be accomplished by inserting some text that appears nowhere else in the document (like [COD_92993] or something) and then modify the .innerHTML of the body by removing that [COD_92993] plus as many characters as there are \b&#8217;s.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-04-17 12:45:03 <br />
@ echo is bad: I&#8217;ve never used that function, could you tell me:
- this is what the code Should look like?
- your name to include in the comment
<hr />


<strong>
echo is bad
</strong>
on 2008-04-16 18:17:48 <br />
Using innerHTML on the BODY is very dangerous because you will break all references to HTMLElements that were done before !

I strongly recommend you to use document.createDocumentFragment.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-04-15 09:03:15 <br />
Probably because it&#8217;s executing a document.write from outside the real document, don&#8217;t you think?
<hr />


<strong>
Philip Peterson
</strong>
on 2008-04-15 08:34:09 <br />
I think this function is breaking php.js tester x.x
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/echo/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/echo/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Kevin van Zonneveld -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/echo/index.html';
        var disqus_url = 'http://phpjs.org/functions/echo/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
