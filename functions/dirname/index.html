
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript dirname function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript dirname function A JavaScript equivalent of PHP&#8217;s dirname filesystem/dirname.js raw on github 1
2
3
4
5
6
7
8
9
10
11
12
function &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/dirname/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <a target="_blank" href="https://github.com/kvz/phpjs">
    <img id="fork-us" style="position: fixed; z-index: 99; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub">
  </a>
  <header role="banner"><hgroup>
  <div id="logo">
    <h1><a href="/">php.js</a></h1>
  	<div class="clear"></div>
  </div>

  
  
    <h2>Learn how to do it in JavaScript. Explore boundaries porting languages. Use functions that turn out to be useful.</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
  <li><a target="_blank" href="https://github.com/kvz/phpjs/wiki/_pages">Wiki</a></li>
  <li><a target="_blank"  href="http://twitter.com/phpjs">@phpjs</a></li>
  <li><a target="_blank"  href="http://identi.ca/brettz9">@brettz9</a></li>
  <li><a target="_blank"  href="http://twitter.com/kvz">@kvz</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript dirname function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s dirname</p>

<figure class='code'><figcaption><span>filesystem/dirname.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/filesystem/dirname.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">dirname</span> <span class="p">(</span><span class="nx">path</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// http://kevin.vanzonneveld.net</span>
</span><span class='line'>  <span class="c1">// +   original by: Ozh</span>
</span><span class='line'>  <span class="c1">// +   improved by: XoraX (http://www.xorax.info)</span>
</span><span class='line'>  <span class="c1">// *     example 1: dirname(&#39;/etc/passwd&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 1: &#39;/etc&#39;</span>
</span><span class='line'>  <span class="c1">// *     example 2: dirname(&#39;c:/Temp/x&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 2: &#39;c:/Temp&#39;</span>
</span><span class='line'>  <span class="c1">// *     example 3: dirname(&#39;/dir/test/&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 3: &#39;/dir&#39;</span>
</span><span class='line'>  <span class="k">return</span> <span class="nx">path</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\\/g</span><span class="p">,</span> <span class="s1">&#39;/&#39;</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/\/[^\/]*\/?$/</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/filesystem/dirname.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/filesystem/dirname.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">dirname</span><span class="p">(</span><span class="s1">&#39;/etc/passwd&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;/etc&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Example 2</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">dirname</span><span class="p">(</span><span class="s1">&#39;c:/Temp/x&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;c:/Temp&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Example 3</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">dirname</span><span class="p">(</span><span class="s1">&#39;/dir/test/&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;/dir&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the filesystem extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/basename">basename</a></li>
<li><a href="/functions/dirname">dirname</a></li>
<li><a href="/functions/fclose">fclose</a></li>
<li><a href="/functions/feof">feof</a></li>
<li><a href="/functions/fgetc">fgetc</a></li>
<li><a href="/functions/fgetcsv">fgetcsv</a></li>
<li><a href="/functions/fgets">fgets</a></li>
<li><a href="/functions/fgetss">fgetss</a></li>
<li><a href="/functions/file">file</a></li>
<li><a href="/functions/file_exists">file_exists</a></li>
<li><a href="/functions/file_get_contents">file_get_contents</a></li>
<li><a href="/functions/filemtime">filemtime</a></li>
<li><a href="/functions/filesize">filesize</a></li>
<li><a href="/functions/fopen">fopen</a></li>
<li><a href="/functions/fpassthru">fpassthru</a></li>
<li><a href="/functions/fread">fread</a></li>
<li><a href="/functions/fscanf">fscanf</a></li>
<li><a href="/functions/fseek">fseek</a></li>
<li><a href="/functions/ftell">ftell</a></li>
<li><a href="/functions/pathinfo">pathinfo</a></li>
<li><a href="/functions/pclose">pclose</a></li>
<li><a href="/functions/popen">popen</a></li>
<li><a href="/functions/readfile">readfile</a></li>
<li><a href="/functions/realpath">realpath</a></li>
<li><a href="/functions/rewind">rewind</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
<a href="http://an3m1.com/" rel="nofollow">???? ????</a>
</strong>
on 2012-04-23 14:50:14 <br />
Write more, that’s all I have to say. Literally, it seems as though you relied on the video to make your point. You clearly know what you’re talking about, why waste your intelligence on just posting videos to your blog when you could be giving us something enlightening to read 
<hr />


<strong>
starmonkey
</strong>
on 2010-02-15 23:35:02 <br />
Using this function:

<pre><code>
dirname(&quot;/index.htm&quot;)
</code></pre>

Gives me 

&quot;&quot;

Using PHP (4):

<pre><code>
echo &quot;&lt;br/&gt;dirname test:&quot;.dirname(&quot;/index.htm&quot;);
</code></pre>

Gives me &quot;dirname test:/&quot;
<hr />


<strong>
<a href="http://getsprink.com" rel="nofollow">Michael White</a>
</strong>
on 2009-05-11 21:39:11 <br />
Hey,

I was working with the __DIR__() and __FILE__() stuff again today and I ran across a bug in this function.

If you pass something like &#8216;filename.js&#8217; to this function in IE7 it will return &#8216;filename.js&#8217; instead of &#8216;.&#8217;

To work around the behavior of IE I modified the function to the following:

[CDOE]
function dirname(path){
    var dir = path.replace(/&#92;/g,&#8217;/&#8217;).replace(/\/[^\/]*\/?$/,&#8221;);
    return (dir &amp;&amp; !dir == path) ? dir : &#8216;.&#8217;;
}
</code></pre>

The only change is to store the result of the regex in a variable and then check to see if the result is empty or if the result is equivalent to the original input.

The result of the regex should only be equal to the original input if using IE7 (6/8????) AND that original input was just the file name and contained no slashes or directory components.
<hr />


<strong>
mk.keck
</strong>
on 2009-03-06 16:04:03 <br />
Hi again,

sorry: in last post there are some mistakes.
If your path leaves outside the window.location.href the path may be wrong.
I&#8217;ve never a seen a system, where you can leave the doc-root ;)

Now here&#8217;s the final function and I hope it would be nice, that realpath is proted php.js ;)

<pre><code>
/**
 * Expands all symbolic links and resolves references
 * to '/./', '/../' and extra '/' characters in the
 * input 'path' and return the canonicalized absolute
 * pathname
 * @param {String} path: the relative pathname
 * Note:
 *     The returned path is an url like e.g.
 *     'http://yourhost.tld/path/'
 */
function realpath(path) {
    var p = 0, arr = [];
    /* Save the root, if not given */
    var r = window.location.href;
    /* Avoid input failures */
    path = (path + '').replace('\\', '/');
    /* Check if there's a port in path (like 'http://') */
    if (path.indexOf('://') !== -1) {
        p = 1;
    }
    /* Ok, there's not a port in path, so let's take the root */
    if (!p) {
        path = r.substring(0, r.lastIndexOf('/') + 1) + path;
    }
    /* Explode the given path into it's parts */
    arr = path.split('/');
    /* The path is an array now */
    path = [];
    /* Foreach part make a check */
    for (var k in arr) {
        /* This is'nt really interesting */
        if (arr[k] == '.') {
            continue;
        }
        /* This reduces the realpath */
        if (arr[k] == '..') {
            /* But only if there more than 3 parts in the path-array.
             * The first three parts are for the uri */
            if (path.length &amp;gt; 3) {
                path.pop();
            }
        }
        /* This adds parts to the realpath */
        else {
            /* But only if the part is not empty or the uri
             * (the first three parts ar needed) was not
             * saved */
            if ((path.length &amp;lt; 2) || (arr[k] !== '')) {
                path.push(arr[k]);
            }
        }
    }
    /* Returns the absloute path as a string */
    return path.join('/');
}


/**
 * EXAMPLES
 * perhabs your window.location.href returns something like this:
 * 'http://www.myserver.com/js/rp/my.html'
 */

// Example 1
    path = 'this/is/../a/test/.//is';
    path = realpath(path);
    // result: 'http://www.myserver.com/js/rp/this/a/test/is'

// Example 2
    path = '../this/is/../a/test/.//is';
    path = realpath(path);
    // result: 'http://www.myserver.com/js/this/a/test/is'

// Example 3
    path = '../../../this/is/../a/test/.//is';
    path = realpath(path);
    // result: 'http://www.myserver.com/this/a/test/is'
    // note:   you can't leave your server ;)
</code></pre>
<hr />


<strong>
mk.keck
</strong>
on 2009-03-05 10:44:56 <br />
My previous function was a bit overkilled so I&#8217;ve made a better one:

<pre><code>
function realpath(path) {
    var p = 0, arr = [];
    var r = window.location.href;
    if (path.indexOf('://') !== -1) {
        p = 1;
    }
    if (!p) {
        path = r.substring(0, r.lastIndexOf('/') + 1)
             + path;
    }
    arr = path.split('/');
    path = [];
    for (var k in arr) {
        if (arr[k] == '.') {
            continue;
        }
        if (arr[k] == '..') {
            path.pop();
        } else {
            if (k &amp;lt; 2 || arr[k] !== '') {
                path.push(arr[k]);
            }
        }
    }
    return path.join('/');
}
</code></pre>

How it works:
<pre><code>
url = 'this/is/../a/./test/.///is';
url = realpath(url);
alert(url);
</code></pre>
will alert something like:
&#8216;http://yourhost.tld/yourpath/this/a/test/is&#8217;

I hope this would be good reason for simulate php&#8217;s realpath function in javascript ;)
<hr />


<strong>
Michael
</strong>
on 2009-03-04 16:07:17 <br />
@ Kevin: jepp I understand.
So here&#8217;s a newer function:
<pre><code>
function realpath(path) {
    var base = '', port = '', parts = [];

    /**
     * Split the given path into port and path
     */
    function urisplit(p) {
        if (p.substring(0, 7).toLowerCase() === 'http://' || p.substring(0, 7).toLowerCase() === 'file://' || p.substring(0, 7).toLowerCase() === 'ftps://') {
            base = p.substring(7, p.length);
            port = p.substring(0, 7);
        } else if (p.substring(0, 8).toLowerCase() === 'https://') {
            base = p.substring(8, p.length);
            port = p.substring(0, 8);
        } else if (p.substring(0, 6).toLowerCase() === 'ftp://') {
            base = p.substring(6, p.length);
            port = p.substring(0, 6);
        }
    }

    /**
     * Make a relative path to an absolute
     * @param {String} s: source path
     * @param {String} r: relative path
     */
    function abspath(s, r) {
        var a = 0, add = '', arr = [], cnt = 0, num = 0, ret = '';
        if (r.substring(0, 2) == './') {
            r = r.substring(2, r.length);
        }
        if (r !== '') {
            arr = r.split('/');
            num = arr.length;
            for (a = 0; a &amp;lt; num; a++) {
                if (arr[a] !== '') {
                    if (arr[a] !== '..') {
                        add += arr[a] + '/';
                    } else {
                        cnt++;
                    }
                }
            }
        }
        if (s !== '') {
            arr = s.split('/');
            num = (arr.length - cnt);
            for (a = 0; a &amp;lt; num; a++) {
                if (arr[a] !== '') {
                    ret += arr[a] + '/';
                }
            }
            ret += add;
        }
        return ret;
    }

    /* check for the port */
    urisplit(path);
    /* path has no port: perhabs relative */
    if (port == '') {
        base = window.location.href;
        base = base.substring(0, base.lastIndexOf('/')) + '/';
        urisplit(base);
        base = abspath(base, path);
    }
    else {
        alert(base);
        base = path.substring(0, path.lastIndexOf('/')) + '/';
        urisplit(base);
    }
    path = port + base;
    return path;
}
</code></pre>

But this would only work if your path like something &#8216;./../path&#8217; or &#8216;./path/&#8217; or &#8216;/path&#8217; or simple &#8216;path&#8217;
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2009-03-04 15:05:04 <br />
@ Michael: In php, realpath is used to make an absolute path, based on a relative one:

e.g.: &#8216;../&#8217; becomes /tmp/ if your pwd is /tmp/abc/

If you&#8217;d want to do that in javascript, you&#8217;d have to base realpath on the location.href or something. 

I haven&#8217;t figured out yet if that would be useful / desirable or not.
<hr />


<strong>
Michael
</strong>
on 2009-03-03 18:54:07 <br />
<pre><code>
function realpath(path) {
   return path.substring(0, path.lastIndexOf('/')) + '/';
}
</code></pre>
gets for me the realpath for any file.

dirname(&#8216;/myfiles/cache/temp/&#8217;);
should return &#8216;/myfiles/cache/temp/&#8217;, so php does it.
Or my I wrong?

But dirname(&#8216;/myfiles/cache/temp/thefile.txt&#8217;);
return the right dirname.

Regards Michael
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-04-29 21:34:17 <br />
@ Philip: Judging by the rexeg, it looks to me like dots are handled just like normal characters. So /etc/vsftpd/../vsftpd.conf should return /etc/vsftpd/..
For relative paths there&#8217;s the function realpath in PHP. Maybe we should port that as well?
<hr />


<strong>
Philip
</strong>
on 2008-04-29 08:55:40 <br />
Question: does it work for things with ../ in it ?  Does the PHP version do it, for that matter?
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-04-28 17:28:22 <br />
@ Xorax: Cool, thank you!
<hr />


<strong>
XoraX
</strong>
on 2008-04-28 11:27:30 <br />
<pre><code>
dirname('/dir/test/'); // output /dir
</code></pre>
so :
<pre><code>
return path.replace(/\\/g,'/').replace(/\/[^\/]*\/?$/, '');
</code></pre>
http://www.xorax.info/
;)
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/dirname/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/dirname/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Kevin van Zonneveld -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/dirname/index.html';
        var disqus_url = 'http://phpjs.org/functions/dirname/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
