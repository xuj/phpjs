
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript base64_encode function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript base64_encode function A JavaScript equivalent of PHP&#8217;s base64_encode url/base64_encode.js raw on github 1
2
3
4
5
6
7
8
9
10
11
12 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/base64_encode/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <a target="_blank" href="https://github.com/kvz/phpjs">
    <img id="fork-us" style="position: fixed; z-index: 99; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub">
  </a>
  <header role="banner"><hgroup>
  <div id="logo">
    <h1><a href="/">php.js</a></h1>
  	<div class="clear"></div>
  </div>

  
    <h2><strong>A community effort to implement PHP functions in JavaScript</strong></h2>
  
  
    <h2>Learn how to do it in JavaScript. Explore boundaries. Use the functions that turn out to be useful.</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
  <li><a target="_blank" href="https://github.com/kvz/phpjs/wiki/_pages">Wiki</a></li>
  <li><a target="_blank"  href="http://twitter.com/phpjs">@phpjs</a></li>
  <li><a target="_blank"  href="http://identi.ca/brettz9">@brettz9</a></li>
  <li><a target="_blank"  href="http://twitter.com/kvz">@kvz</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript base64_encode function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s base64_encode</p>

<figure class='code'><figcaption><span>url/base64_encode.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/url/base64_encode.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">base64_encode</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// http://kevin.vanzonneveld.net</span>
</span><span class='line'>  <span class="c1">// +   original by: Tyler Akins (http://rumkin.com)</span>
</span><span class='line'>  <span class="c1">// +   improved by: Bayron Guevara</span>
</span><span class='line'>  <span class="c1">// +   improved by: Thunder.m</span>
</span><span class='line'>  <span class="c1">// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Pellentesque Malesuada</span>
</span><span class='line'>  <span class="c1">// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span>
</span><span class='line'>  <span class="c1">// +   improved by: Rafał Kukawski (http://kukawski.pl)</span>
</span><span class='line'>  <span class="c1">// *     example 1: base64_encode(&#39;Kevin van Zonneveld&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 1: &#39;S2V2aW4gdmFuIFpvbm5ldmVsZA==&#39;</span>
</span><span class='line'>  <span class="c1">// mozilla has this native</span>
</span><span class='line'>  <span class="c1">// - but breaks in 2.0.0.12!</span>
</span><span class='line'>  <span class="c1">//if (typeof this.window[&#39;btoa&#39;] == &#39;function&#39;) {</span>
</span><span class='line'>  <span class="c1">//    return btoa(data);</span>
</span><span class='line'>  <span class="c1">//}</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">b64</span> <span class="o">=</span> <span class="s2">&quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;</span><span class="p">;</span>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">o1</span><span class="p">,</span> <span class="nx">o2</span><span class="p">,</span> <span class="nx">o3</span><span class="p">,</span> <span class="nx">h1</span><span class="p">,</span> <span class="nx">h2</span><span class="p">,</span> <span class="nx">h3</span><span class="p">,</span> <span class="nx">h4</span><span class="p">,</span> <span class="nx">bits</span><span class="p">,</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">ac</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">enc</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">tmp_arr</span> <span class="o">=</span> <span class="p">[];</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="k">return</span> <span class="nx">data</span><span class="p">;</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">do</span> <span class="p">{</span> <span class="c1">// pack three octets into four hexets</span>
</span><span class='line'>    <span class="nx">o1</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="o">++</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">o2</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="o">++</span><span class="p">);</span>
</span><span class='line'>    <span class="nx">o3</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="o">++</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">bits</span> <span class="o">=</span> <span class="nx">o1</span> <span class="o">&lt;&lt;</span> <span class="mi">16</span> <span class="o">|</span> <span class="nx">o2</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="nx">o3</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="nx">h1</span> <span class="o">=</span> <span class="nx">bits</span> <span class="o">&gt;&gt;</span> <span class="mi">18</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">h2</span> <span class="o">=</span> <span class="nx">bits</span> <span class="o">&gt;&gt;</span> <span class="mi">12</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">h3</span> <span class="o">=</span> <span class="nx">bits</span> <span class="o">&gt;&gt;</span> <span class="mi">6</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">;</span>
</span><span class='line'>    <span class="nx">h4</span> <span class="o">=</span> <span class="nx">bits</span> <span class="o">&amp;</span> <span class="mh">0x3f</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>    <span class="c1">// use hexets to index into b64, and append result to encoded string</span>
</span><span class='line'>    <span class="nx">tmp_arr</span><span class="p">[</span><span class="nx">ac</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nx">b64</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">h1</span><span class="p">)</span> <span class="o">+</span> <span class="nx">b64</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">h2</span><span class="p">)</span> <span class="o">+</span> <span class="nx">b64</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">h3</span><span class="p">)</span> <span class="o">+</span> <span class="nx">b64</span><span class="p">.</span><span class="nx">charAt</span><span class="p">(</span><span class="nx">h4</span><span class="p">);</span>
</span><span class='line'>  <span class="p">}</span> <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">enc</span> <span class="o">=</span> <span class="nx">tmp_arr</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">r</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">length</span> <span class="o">%</span> <span class="mi">3</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="p">(</span><span class="nx">r</span> <span class="o">?</span> <span class="nx">enc</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nx">r</span> <span class="o">-</span> <span class="mi">3</span><span class="p">)</span> <span class="o">:</span> <span class="nx">enc</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;===&#39;</span><span class="p">.</span><span class="nx">slice</span><span class="p">(</span><span class="nx">r</span> <span class="o">||</span> <span class="mi">3</span><span class="p">);</span>
</span><span class='line'>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/url/base64_encode.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/url/base64_encode.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">base64_encode</span><span class="p">(</span><span class="s1">&#39;Kevin van Zonneveld&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;S2V2aW4gdmFuIFpvbm5ldmVsZA==&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the url extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/base64_decode">base64_decode</a></li>
<li><a href="/functions/base64_encode">base64_encode</a></li>
<li><a href="/functions/get_headers">get_headers</a></li>
<li><a href="/functions/get_meta_tags">get_meta_tags</a></li>
<li><a href="/functions/http_build_query">http_build_query</a></li>
<li><a href="/functions/parse_url">parse_url</a></li>
<li><a href="/functions/rawurldecode">rawurldecode</a></li>
<li><a href="/functions/rawurlencode">rawurlencode</a></li>
<li><a href="/functions/urldecode">urldecode</a></li>
<li><a href="/functions/urlencode">urlencode</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
<a href="http://an3m1.com/" rel="nofollow">????? ???</a>
</strong>
on 2012-04-23 14:46:56 <br />
I have a lot to benefit from this article and thank you for this wonderful effort to this article and will continue my many articles you have other   
<hr />


<strong>
<a href="www.walnutcomputing.com" rel="nofollow">Daniel Dotsenko</a>
</strong>
on 2012-03-08 19:52:18 <br />
Per my tests pre-splitting the string, with consequent use of array[index] lookup is 3 times faster on IE - the only browser you would use this on. (All others have btoa())

In addition to that, Closure Compiler for some reason &quot;optimizes&quot; the code above (long string with 4x .charAt look up in that string) into 4 fold repetition of that string within minified code. I know it&#8217;s Closure&#8217;s faulty &quot;optimization&quot; logic, but switching to array helps it do the right thing.

Here is something that behaved about 3 times faster (on IE) than the code you have above (on long 20k+ texts) in our use:

<pre><code>
function base64_encode(data) {
    // use native implementation if it's present
    if (typeof btoa === 'function') return btoa(data)

    var b64 = &quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&quot;,
        b64a = b64.split(''),
        o1, o2, o3, h1, h2, h3, h4, bits, i = 0,
        ac = 0,
        enc = &quot;&quot;,
        tmp_arr = [];
 
    do { // pack three octets into four hexets
        o1 = data.charCodeAt(i++);
        o2 = data.charCodeAt(i++);
        o3 = data.charCodeAt(i++);
 
        bits = o1 &lt;&lt; 16 | o2 &lt;&lt; 8 | o3;
 
        h1 = bits &gt;&gt; 18 &amp; 0x3f;
        h2 = bits &gt;&gt; 12 &amp; 0x3f;
        h3 = bits &gt;&gt; 6 &amp; 0x3f;
        h4 = bits &amp; 0x3f;
 
        // use hexets to index into b64, and append result to encoded string
        tmp_arr[ac++] = b64a[h1] + b64a[h2] + b64a[h3] + b64a[h4];
    } while (i &lt; data.length);

    enc = tmp_arr.join('');
    var r = data.length % 3;
    return (r ? enc.slice(0, r - 3) : enc) + '==='.slice(r || 3);
}
</code></pre>


test is here: 
http://jsperf.com/base64-most-referred-mit-and-bsd-vs-native-btoa/2
<hr />


<strong>
austin
</strong>
on 2012-02-29 23:00:49 <br />
base64_encode mangles utf8 binary data this line:
<pre><code>
data = this.utf8_encode(data + '');
</code></pre>
if the string is already utf8 it encodes it MORE and the resulting binary is unintelligible.
a fix i used for this is:
<pre><code>
if(!isutf8)
    {
      data = this.utf8_encode(data + '');
    }
</code></pre>
and i pass isutf8 as a second argument, this changes it a bit from the original but gives the option to utf8 encode it first or not.
<hr />


<strong>
<a href="http://www.jj5.net/" rel="nofollow">John</a>
</strong>
on 2011-12-27 18:31:04 <br />
I fixed this function over at jsphp.co:

http://jsphp.co/jsphp/fn/diff/base64_encode?a=389&amp;b=460
<hr />


<strong>
<a href="http://www.jj5.net/" rel="nofollow">John</a>
</strong>
on 2011-07-19 21:46:11 <br />
The line,

<pre><code>
    data = this.utf8_encode(data + '');
</code></pre>

is incorrect. PHP treats input to base64_encode as a binary string. I had to comment out this code in order to get compatibility with existing PHP code that uses binary strings. I&#8217;d advise removing this line altogether, it doesn&#8217;t make sense, especially as the input is likely already in UTF-8 encoding, and if it&#8217;s not then it&#8217;s probably a binary string (or some other encoding, in any event that line shouldn&#8217;t be there).
<hr />


<strong>
<a href="patronum.tk" rel="nofollow">Seingh</a>
</strong>
on 2011-02-01 20:43:52 <br />
I did not understand much code written by you, in theory, should have a javascript function to base64.
Obviously I can be wrong;-)
Sorry for my English, I&#8217;m Italian.
<hr />


<strong>
justin
</strong>
on 2010-12-24 07:38:07 <br />
when the raw date is chinese,the base64_encode has diff result with the php base64_encode
<hr />


<strong>
weblink
</strong>
on 2010-07-02 08:40:31 <br />
I used phpjs functions serialize(), utf8-encode() and base64_encode(). This is my javascript code 
<pre><code>
 var string = &quot;„œœ„‚XSS[…„–Ž„•&quot;
 result=serialize(string);
 alert(base64_encode(result));
</code></pre>

If i use serialize &amp; base64_encode in php functions in my php program, it is giving &quot;czoxNToihJychIJYU1NbhYSWjoSVIjs=&quot;.

But, in the above code i am getting wrong output.

Can anyone give suggestion for this problem that i need to get the same output like php.
<hr />


<strong>
zeroneta
</strong>
on 2010-01-05 17:37:28 <br />
<pre><code>
_.unicode = _._.String.fromCharCode
</code></pre>
<hr />


<strong>
zeroneta
</strong>
on 2010-01-05 17:33:58 <br />
_.encode = function( a )
{
    return ( a + &#8221; ).replace( /[^\x00-\xFF]/g, function( a )
    {
        a = a.charCodeAt();
        return a &lt; 2048 ? _.unicode( a &gt;&gt; 6 | 192 ) + _.unicode( a &amp; 63 | 128 ) : _.unicode( a &gt;&gt; 12 | 224 ) + _.unicode( a &gt;&gt; 6 &amp; 63 | 128 ) + _.unicode( a &amp; 63 | 128 );
    } );
},
_.base64_encode = function( a )
{
    a = _.encode( a );
    for ( var s = 0, d = a.length, f = &#8221;, r; s &lt; d; r = a.charCodeAt( s++ ) &lt;&lt; 16 | a.charCodeAt( s++ ) &lt;&lt; 8 | a.charCodeAt( s++ ), f += base64.charAt( r &gt;&gt; 18 &amp; 0x3F ) + base64.charAt( r &gt;&gt; 12 &amp; 0x3F ) + base64.charAt( r &gt;&gt; 6 &amp; 0x3F ) + base64.charAt( r &amp; 0x3F ) );
    return ( d %= 3 ) ? d &gt; 1 ? f.slice( 0, -1 ) + &#8216;=&#8217; : f.slice( 0, -2 ) + &#8216;==&#8217; : f;
},
<hr />


<strong>
<a href="http://noe.wen9.net/" rel="nofollow">noe</a>
</strong>
on 2009-10-01 11:10:57 <br />
Thank&#8217;s
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-08-30 05:25:09 <br />
@Ulrich: I assume the function creators were trying to just make it more convenient for themselves in handling newlines in a uniform way, but as you are correct that this is not the PHP way, and it should not be the job of this function to streamline newlines, I&#8217;ve applied your fix in SVN (i.e., removing the newline replaces).
<hr />


<strong>
Ulrich
</strong>
on 2009-08-27 19:26:25 <br />
Ok, I was a bit wrong with my previouse post&#8230;
It looks like if JavaScript is handling strings in a different way and not as byte arrays, so utf8_encode seems to be required. But I still wonder why \r has to be replaced.
<hr />


<strong>
Ulrich
</strong>
on 2009-08-27 18:37:41 <br />
I don&#8217;t understand, why you are doing an utf8-encoding before encoding the data with base64. If we assume that our string &quot;data&quot; is just a byte array, it does not have any encoding. Base64 will work on a byte array and it shouldn&#8217;t care about encoding. As far as I can see utf8-encoding is also destroying the data. If \r gets replaced by \n, for example, information is lost.

PHP example (File encoding is UTF-8):
<pre><code>
&lt;?php

$str1_1 = chr(0xc4); // iso 8859-1 &quot;Ä&quot;
$str1_2 = &quot;Ä&quot;;
$str2 = &quot;\n&quot;;
$str3 = &quot;\r&quot;;
$str4 = &quot;\r\n&quot;;

echo $str1_1, &quot;\n&quot;;
echo $str1_2, &quot;\n&quot;;
echo $str2, &quot;\n&quot;;
echo $str3, &quot;\n&quot;;
echo $str4, &quot;\n&quot;;

echo &quot;---\n&quot;;

echo base64_encode($str1_1), &quot;\n&quot;;
echo base64_encode($str1_2), &quot;\n&quot;;
echo base64_encode($str2), &quot;\n&quot;;
echo base64_encode($str3), &quot;\n&quot;;
echo base64_encode($str4), &quot;\n&quot;;

echo &quot;===\n&quot;;

echo utf8_encode($str1_1), &quot;\n&quot;;
echo utf8_encode($str1_2), &quot;\n&quot;;
echo utf8_encode($str2), &quot;\n&quot;;
echo utf8_encode($str3), &quot;\n&quot;;
echo utf8_encode($str4), &quot;\n&quot;;

echo &quot;---\n&quot;;

echo base64_encode(utf8_encode($str1_1)), &quot;\n&quot;;
echo base64_encode(utf8_encode($str1_2)), &quot;\n&quot;;
echo base64_encode(utf8_encode($str2)), &quot;\n&quot;;
echo base64_encode(utf8_encode($str3)), &quot;\n&quot;;
echo base64_encode(utf8_encode($str4)), &quot;\n&quot;;

?&gt;
</code></pre>

RESULT:
<pre><code>
$ php php_test.php

Ä





---
xA==
w4Q=
Cg==
DQ==
DQo=
===
Ä
Ã





---
w4Q=
w4PChA==
Cg==
DQ==
DQo=
</code></pre>

Or does JavaScript handles strings in a different way?
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-05-02 11:42:06 <br />
@ Thunder.m: Thank you for testing it in 2.0.0.12. It appears various versions handle atob() functions differently. Doing a browser version check isn&#8217;t very reliable, so I guess I will fall back to the original function which works consistently in all JavaScript browsers. The fixed version will be visible shortly.
<hr />


<strong>
Thunder.m
</strong>
on 2008-04-30 14:22:46 <br />
Hi, the mozilla atob function is not working well in my Firefox 2.0.0.12, there are some realy serious issues, so i think it shuld be removed, or tested more intensively.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-04-25 11:04:08 <br />
@ Howard Yeend &amp;amp; TXGruppi: I&#8217;ve added a:
<pre><code>
    // mozilla has this native
    if (typeof window['atob'] == 'function') {
        return atob(data);
    }
</code></pre>
To make use of mozilla&#8217;s native base64 functions.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-04-25 10:57:48 <br />
@ Thunder.m: Thanks, I&#8217;ve updated the code and added the utf dependency!
<hr />


<strong>
Thunder.m
</strong>
on 2008-04-24 19:16:23 <br />
This function (base64_encode and decode) is not correct for utf strings.
Here is working solution: http://www.webtoolkit.info/javascript-base64.html
<hr />


<strong>
Howard Yeend
</strong>
on 2008-04-09 18:55:45 <br />
&amp;quot;check on the existance of the btoa function and then decide which method to use&amp;quot;

oops. just read that.
<hr />


<strong>
Howard Yeend
</strong>
on 2008-04-09 18:54:28 <br />
Confirmed btoa and atob working on:

* Safaru 3.0.4 under windows
* Firefox 2.0.0.13 under windows

Not working in:

* Any version of MSIE.


Instead of using a UA check, why not do this:

<pre><code>
if(!function_exists(atob)) {
 function atob() {
 // funky b64 code here
 }
}

if(!function_exists(btoa)) {
 function btoa() {
 // funky b64 code here
 }
}

</code></pre>
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-04-08 23:11:54 <br />
@ TXGruppi: Wow didn&#8217;t know about that. Googling gave me the idea that this is mozilla only however. Can you confirm this? If so, we can always build in a browsercheck or a check on the existance of the btoa function and then decide which method to use
<hr />


<strong>
TXGruppi
</strong>
on 2008-04-08 19:16:26 <br />
Reading the functions I found the base64_encode and base64_decode in a way very complicated.

There are the functions btoa and atob in JavaScript that make this conversion.

<pre><code>
var name = 'JavaScript';
var enc = btoa(name);
var dec = atob(enc);
alert(name); // JavaScript
alert(enc); // SmF2YVNjcmlwdA==
alert(dec); // JavaScript
</code></pre>

Any questions send me an email: txgruppi@gmail.com

Translated by: Google Translator
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-01-04 20:27:08 <br />
@ Bayron Guevara: Thank you I&#8217;ve updated the function and credited you in the comments! If you have thoughts on new functions as well, let me know!
<hr />


<strong>
Bayron Guevara
</strong>
on 2008-01-04 18:01:14 <br />
I suggest the following code, because I think is faster:

function base64_encode(data) {
    
    var b64 = &amp;quot;ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=&amp;quot;;
    var o1, o2, o3, h1, h2, h3, h4, bits, i=0, enc=&#8221;;
        
    do {  // pack three octets into four hexets
        o1 = data.charCodeAt(i++);
        o2 = data.charCodeAt(i++);
        o3 = data.charCodeAt(i++);
        
        bits = o1&amp;lt;&amp;lt;16 | o2&amp;lt;&amp;lt;8 | o3;
        
        h1 = bits&amp;gt;&amp;gt;18 &amp;amp; 0x3f;
        h2 = bits&amp;gt;&amp;gt;12 &amp;amp; 0x3f;
        h3 = bits&amp;gt;&amp;gt;6 &amp;amp; 0x3f;
        h4 = bits &amp;amp; 0x3f;
              
        // use hexets to index into b64, and append result to encoded string
        enc += b64.charAt(h1) + b64.charAt(h2) + b64.charAt(h3) + b64.charAt(h4);
    } while (i &amp;lt; data.length);
    
    switch( data.length % 3 ){
        case 1:
            enc = enc.slice(0, -2) + &#8216;==&#8217;;
            break;
        case 2:
            enc = enc.slice(0, -1) + &#8216;=&#8217;;
    }
    
    return enc;
}
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/base64_encode/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/base64_encode/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Kevin van Zonneveld -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/base64_encode/index.html';
        var disqus_url = 'http://phpjs.org/functions/base64_encode/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
