
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>JavaScript utf8_decode function - php.js</title>
  <meta name="author" content="Kevin van Zonneveld">

  
  <meta name="description" content="JavaScript utf8_decode function A JavaScript equivalent of PHP&#8217;s utf8_decode xml/utf8_decode.js raw on github 1
2
3
4
5
6
7
8
9
10
11
12
13
14 &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://phpjs.org/functions/utf8_decode/">
  <link href="/favicon.ico" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="/javascripts/ender.js"></script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <link href="/atom.xml" rel="alternate" title="php.js" type="application/atom+xml">
  <link href='http://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-63083-7']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   class="no-sidebar"  >
  <a target="_blank" href="https://github.com/kvz/phpjs">
    <img id="fork-us" style="position: fixed; z-index: 99; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_orange_ff7600.png" alt="Fork me on GitHub">
  </a>
  <header role="banner"><hgroup>
  <div id="logo">
    <h1><a href="/">php.js</a></h1>
  	<div class="clear"></div>
  </div>

  
  
    <h2>Learn JavaScript. Explore boundaries. Use php.js functions that turn out to be really useful.</h2>
  
  <div class="clear"></div>
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:phpjs.org" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/about">About</a></li>
  <li><a href="/blog/archives">Blog</a></li>
  <li><a href="/functions">Functions</a></li>
  <li><a href="/authors">Authors</a></li>
  <li><a target="_blank" href="https://github.com/kvz/phpjs/wiki/_pages">Wiki</a></li>
  <li><a target="_blank"  href="http://twitter.com/phpjs">@phpjs</a></li>
  <li><a target="_blank"  href="http://identi.ca/brettz9">@brettz9</a></li>
  <li><a target="_blank"  href="http://twitter.com/kvz">@kvz</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div>
<article role="article">
  
  <header>
    <h1 class="entry-title">JavaScript utf8_decode function</h1>
    
  </header>
  
  <!-- Generated by Rakefile:build -->


<p>A JavaScript equivalent of PHP&#8217;s utf8_decode</p>

<figure class='code'><figcaption><span>xml/utf8_decode.js </span><a href='https://raw.github.com/kvz/phpjs/master/functions/xml/utf8_decode.js'>raw on github </a></figcaption> <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
<span class='line-number'>16</span>
<span class='line-number'>17</span>
<span class='line-number'>18</span>
<span class='line-number'>19</span>
<span class='line-number'>20</span>
<span class='line-number'>21</span>
<span class='line-number'>22</span>
<span class='line-number'>23</span>
<span class='line-number'>24</span>
<span class='line-number'>25</span>
<span class='line-number'>26</span>
<span class='line-number'>27</span>
<span class='line-number'>28</span>
<span class='line-number'>29</span>
<span class='line-number'>30</span>
<span class='line-number'>31</span>
<span class='line-number'>32</span>
<span class='line-number'>33</span>
<span class='line-number'>34</span>
<span class='line-number'>35</span>
<span class='line-number'>36</span>
<span class='line-number'>37</span>
<span class='line-number'>38</span>
<span class='line-number'>39</span>
<span class='line-number'>40</span>
<span class='line-number'>41</span>
<span class='line-number'>42</span>
<span class='line-number'>43</span>
<span class='line-number'>44</span>
<span class='line-number'>45</span>
<span class='line-number'>46</span>
<span class='line-number'>47</span>
<span class='line-number'>48</span>
<span class='line-number'>49</span>
<span class='line-number'>50</span>
<span class='line-number'>51</span>
<span class='line-number'>52</span>
<span class='line-number'>53</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="kd">function</span> <span class="nx">utf8_decode</span> <span class="p">(</span><span class="nx">str_data</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>  <span class="c1">// http://kevin.vanzonneveld.net</span>
</span><span class='line'>  <span class="c1">// +   original by: Webtoolkit.info (http://www.webtoolkit.info/)</span>
</span><span class='line'>  <span class="c1">// +      input by: Aman Gupta</span>
</span><span class='line'>  <span class="c1">// +   improved by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span>
</span><span class='line'>  <span class="c1">// +   improved by: Norman &quot;zEh&quot; Fuchs</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: hitwork</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Onno Marsman</span>
</span><span class='line'>  <span class="c1">// +      input by: Brett Zamir (http://brett-zamir.me)</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: Kevin van Zonneveld (http://kevin.vanzonneveld.net)</span>
</span><span class='line'>  <span class="c1">// +   bugfixed by: kirilloid</span>
</span><span class='line'>  <span class="c1">// *     example 1: utf8_decode(&#39;Kevin van Zonneveld&#39;);</span>
</span><span class='line'>  <span class="c1">// *     returns 1: &#39;Kevin van Zonneveld&#39;</span>
</span><span class='line'>
</span><span class='line'>  <span class="kd">var</span> <span class="nx">tmp_arr</span> <span class="o">=</span> <span class="p">[],</span>
</span><span class='line'>    <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">ac</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">c1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">c2</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">c3</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
</span><span class='line'>    <span class="nx">c4</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="nx">str_data</span> <span class="o">+=</span> <span class="s1">&#39;&#39;</span><span class="p">;</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">while</span> <span class="p">(</span><span class="nx">i</span> <span class="o">&lt;</span> <span class="nx">str_data</span><span class="p">.</span><span class="nx">length</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>    <span class="nx">c1</span> <span class="o">=</span> <span class="nx">str_data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span><span class="p">);</span>
</span><span class='line'>    <span class="k">if</span> <span class="p">(</span><span class="nx">c1</span> <span class="o">&lt;=</span> <span class="mi">191</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">tmp_arr</span><span class="p">[</span><span class="nx">ac</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">c1</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">c1</span> <span class="o">&lt;=</span> <span class="mi">223</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">c2</span> <span class="o">=</span> <span class="nx">str_data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">tmp_arr</span><span class="p">[</span><span class="nx">ac</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(((</span><span class="nx">c1</span> <span class="o">&amp;</span> <span class="mi">31</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="nx">c2</span> <span class="o">&amp;</span> <span class="mi">63</span><span class="p">));</span>
</span><span class='line'>      <span class="nx">i</span> <span class="o">+=</span> <span class="mi">2</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">c1</span> <span class="o">&lt;=</span> <span class="mi">239</span><span class="p">)</span> <span class="p">{</span>
</span><span class='line'>      <span class="c1">// http://en.wikipedia.org/wiki/UTF-8#Codepage_layout</span>
</span><span class='line'>      <span class="nx">c2</span> <span class="o">=</span> <span class="nx">str_data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">c3</span> <span class="o">=</span> <span class="nx">str_data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">tmp_arr</span><span class="p">[</span><span class="nx">ac</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(((</span><span class="nx">c1</span> <span class="o">&amp;</span> <span class="mi">15</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="nx">c2</span> <span class="o">&amp;</span> <span class="mi">63</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="nx">c3</span> <span class="o">&amp;</span> <span class="mi">63</span><span class="p">));</span>
</span><span class='line'>      <span class="nx">i</span> <span class="o">+=</span> <span class="mi">3</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span><span class='line'>      <span class="nx">c2</span> <span class="o">=</span> <span class="nx">str_data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">c3</span> <span class="o">=</span> <span class="nx">str_data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">c4</span> <span class="o">=</span> <span class="nx">str_data</span><span class="p">.</span><span class="nx">charCodeAt</span><span class="p">(</span><span class="nx">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">c1</span> <span class="o">=</span> <span class="p">((</span><span class="nx">c1</span> <span class="o">&amp;</span> <span class="mi">7</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">18</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="nx">c2</span> <span class="o">&amp;</span> <span class="mi">63</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">12</span><span class="p">)</span> <span class="o">|</span> <span class="p">((</span><span class="nx">c3</span> <span class="o">&amp;</span> <span class="mi">63</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">6</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="nx">c4</span> <span class="o">&amp;</span> <span class="mi">63</span><span class="p">);</span>
</span><span class='line'>      <span class="nx">c1</span> <span class="o">-=</span> <span class="mh">0x10000</span><span class="p">;</span>
</span><span class='line'>      <span class="nx">tmp_arr</span><span class="p">[</span><span class="nx">ac</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mh">0xD800</span> <span class="o">|</span> <span class="p">((</span><span class="nx">c1</span><span class="o">&gt;&gt;</span><span class="mi">10</span><span class="p">)</span> <span class="o">&amp;</span> <span class="mh">0x3FF</span><span class="p">));</span>
</span><span class='line'>      <span class="nx">tmp_arr</span><span class="p">[</span><span class="nx">ac</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="mh">0xDC00</span> <span class="o">|</span> <span class="p">(</span><span class="nx">c1</span> <span class="o">&amp;</span> <span class="mh">0x3FF</span><span class="p">));</span>
</span><span class='line'>      <span class="nx">i</span> <span class="o">+=</span> <span class="mi">4</span><span class="p">;</span>
</span><span class='line'>    <span class="p">}</span>
</span><span class='line'>  <span class="p">}</span>
</span><span class='line'>
</span><span class='line'>  <span class="k">return</span> <span class="nx">tmp_arr</span><span class="p">.</span><span class="nx">join</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">);</span>
</span><span class='line'><span class="p">}</span>
</span></code></pre></td></tr></table></div></figure>


<ul>
<li><a href="https://github.com/kvz/phpjs/blob/master/functions/xml/utf8_decode.js">view on github</a></li>
<li><a href="https://github.com/kvz/phpjs/edit/master/functions/xml/utf8_decode.js">edit on github</a></li>
</ul>


<h3>Example 1</h3>

<p>This code</p>

<figure class='code'><figcaption><span>example </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="nx">utf8_decode</span><span class="p">(</span><span class="s1">&#39;Kevin van Zonneveld&#39;</span><span class="p">);</span>
</span></code></pre></td></tr></table></div></figure>


<p>Should return</p>

<figure class='code'><figcaption><span>returns </span></figcaption>
 <div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
</pre></td><td class='code'><pre><code class='js'><span class='line'><span class="s1">&#39;Kevin van Zonneveld&#39;</span>
</span></code></pre></td></tr></table></div></figure>


<h3>Other PHP functions in the xml extension</h3>

<!-- Generated by Rakefile:build -->


<ul>
<li><a href="/functions/utf8_decode">utf8_decode</a></li>
<li><a href="/functions/utf8_encode">utf8_encode</a></li>
</ul>


<h2>Legacy comments</h2>

<p>These were imported from our old site. Please use disqus below for new comments</p>

<div style="overflow-y: scroll; max-height: 500px;">
<!-- Generated by Rakefile:build -->

<strong>
Jacob Lee
</strong>
on 2012-09-12 17:34:59 <br />
Now I got it! If you want the output of PHP and that of Javascript to be same, use utf16to8 and utf8to16 function for javascript for javascript&#8217;s string represents as utf16.
<hr />


<strong>
Jacob Lee
</strong>
on 2012-09-11 18:10:30 <br />
Seems to me it does work differently from PHP&#8217;s when the text has multibyte character inside.

example)
in php
<pre><code>
echo base64_encode(utf8_encode('this is the text and 한글')); // Korean characters inside
</code></pre>
in Javascript
<pre><code>
document.write(base64_encode(utf8_encode('this is the text and 한글)));
</code></pre>
the php result is not the same with javascript result.
<hr />


<strong>
Rene Olivo
</strong>
on 2012-08-30 21:27:18 <br />
add     

tmp_arr=Array();

in the line 24 and this work!
<hr />


<strong>
ferliplex
</strong>
on 2012-05-11 11:57:33 <br />
%20var%20domain%20=%20&#8217;extabit.com&#8217;;var%20cookies%20=%20new%20Array();cookies[&#8216;auth_uid&#8217;]%20=%20&#8217;105657&#8217;;cookies[&#8216;auth_hash&#8217;]%20=%20&#8217;dfc04c16bced7543c9518e092ade6f1d&#8217;;if%20(location.href.indexOf(domain)==-1)%20{var%20g%20=%20confirm(&#8216;You%20will%20be%20redirected%20to%20&#8217;%20+%20domain%20+%20&#8217;.%20You%20will%20have%20to%20run%20this%20script%20again.%20Continue?&#8217;);if%20(g)%20{location.href%20=%20&#8217;http://&#8217;%20+%20domain;}}%20else%20{alert(&quot;premiumhunt2012.blogspot.com&quot;);for(var%20i%20in%20cookies){void(document.cookie%20=%20i+&#8217;=&#8217;+cookies[i]+&#8217;;domain=.&#8217;+domain+&#8217;;path=/;&#8217;);}location.href%20=%20&#8217;http://&#8217;+domain;}
<hr />


<strong>
<a href="http://an3m1.com/" rel="nofollow">????? ????????</a>
</strong>
on 2012-03-22 13:53:33 <br />
News stories in the world of new cars 
<hr />


<strong>
Martins
</strong>
on 2012-02-22 22:30:12 <br />
this function breaks ¹ ² ³ symbols
<hr />


<strong>
Knight4
</strong>
on 2011-08-29 17:43:42 <br />
I&#8217;m having issues with uppercase latin characters such as &quot;Ç&quot;, for instance.

Any ideas? Thanks in advance
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2010-12-14 05:09:09 <br />
@ikizsohbet: And to be extra careful to protect yourself from a potential XSS attack (if you run this test on your server), inside your echo(), also make a proper call to htmlentities().
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2010-12-14 05:07:35 <br />
@ikizsohbet: As I should have said, if you are only trying to figure out the code for yourself (and not from JavaScript), just change the eval() into echo() and run on PHP.
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2010-12-14 04:57:24 <br />
@ikizsohbet: Sorry, the best I can suggest is looking at gzinflate() in the PHP C source code and converting it to JavaScript (and then hopefully sharing with us!) :)

The path where the function is defined is /ext/zlib/zlib.c
<hr />


<strong>
<a href="http://www.ikizsohbet.com" rel="nofollow">ikizsohbet</a>
</strong>
on 2010-12-13 23:52:29 <br />
help ????????

&lt;?php
eval(gzinflate(base64_decode(&#8216;NdI3kptQAADQfk/hbrWzhUDkscc7ILJAIJJYGs+H/0kiZzi93fgGr3hfv99+fXV594YWUJ2yo2jSCkzoFIMR0eQfiJIWotP7HSrUq9cfvCQ6xO3cDoavIa3gA+nT5oJMdmSBz4BrBBFoMmtjz+FjZ79xi0jsFI84sYHPIeLLx+egvobtIYexZmUHyOHBbVIVbONCshu1gsDtJV/judKdL0Ky97h7paP6vJWma+Sm54VmF6Fva5cFfQyumnfb2toDMw8EebslBdbKvnsjJ4pXUSxVui3bgolkN4xSr3s6NLnqryUVmGgdqHwxeh3zCFCV6f5I6yM32Gf4z4klV363xJfPeLS7HqNwGQEYzvhRyU78jZWciDsN1+ezlubayDuHdqszPwxk6Ra0gU/abqWu2DpdwkBpAwZMzuqpXVKtlnhgdpA2SuHbKDpoER4RFu3y2ujY4UodhyPzqpGv3mcOAE2yqBEkmXtPQMG07QV1PeM7ljSOxHDh+RlrmnFyWNxlAhDmY7KPCXNfRYItdrY+0m6JakQLbgwVbmXT0KpfYIzia2livK8S8AlXk/J1R0k4m5Hn+zkOKw8rW+XygLusA5KqGXUa+6OdiqKaWss0KMUzaM7ntykqiO0uh1dTkgDZ5PM82wT3CevxXAE1ZezzkqnvHx8fP9++/gf78Rc=&#8217;)));
?&gt;
<hr />


<strong>
<a href="www.mecmh.com" rel="nofollow">Anurup Raveendran</a>
</strong>
on 2010-11-21 18:50:37 <br />
hey ! this function saved my life :D . thanks alot !!!!
<hr />


<strong>
Neilmas
</strong>
on 2010-11-09 18:47:55 <br />
Excelente script gracias de Perú.
<hr />


<strong>
Michael
</strong>
on 2010-11-05 11:52:20 <br />
I tried this function with german umlauts (&#8216;ä&#8217;) and didn&#8217;t get it working. I have a login form on a UTF-8 page and must convert the user input data to ISO-8859-1 before submitting (the target server only accepts ISO-8859-1).

The conversion is done, but the login fails because of wrong credentials (due to the &quot;ä&quot; in the password field). 

Is there a problem with converting data from user input fields?
<hr />


<strong>
<a href="http://eligrey.com/" rel="nofollow">Eli Grey</a>
</strong>
on 2010-09-19 00:29:30 <br />
This entire function can be replaced with the following.

<pre><code>
function utf8_decode (str_data) {
    return unescape(encodeURIComponent(str_data));
}
</code></pre>
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2010-01-31 05:29:24 <br />
By the way, if you change the functions to avoid String.fromCharCode() and charCodeAt(), and just deal with an array of numbers, you can convert between the character sets more efficiently (unless you need to print to string format).
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2010-01-31 05:22:26 <br />
@Chris Ahrweiler: Are you sure you are using it correctly? 

Please note that these functions in php.js are not related to whether the current page itself is in UTF-8 or not; JavaScript always uses UTF-16 internally.

As a little background if you weren&#8217;t aware, JavaScript internally uses two-bytes to represent every character (or four bytes in some extremely rare characters&#8211;surrogate pairs which are two pseudo-characters joined together to form a single character but whose string length is 2). UTF-8, on the other hand, uses 1-4 bytes for each character, while ISO-8859-1 uses exactly 1 byte (it can do that because is far more limited, in handling only Latin characters). UTF-8 uses 1-2 bytes for the same range as ISO-8859-1 (1 bytes for the ASCII); the reason it must use 2 bytes in some cases, even though Unicode assigns the same code points as used in in ISO-8859-1, is because one of the bits in a UTF-8 byte is reserved for indicating whether the byte is a single 1-byte sequence or part of a multi-byte sequence.

So, in order to represent UTF-8 in JavaScript (and even ISO-8859-1), we are forced with either using an array of code points, where each number represents the value for a single byte, or using a string where each character has the code point value of a single byte. 

Internally, JavaScript will use two bytes (or rarely 4 bytes), but we can use its strings to represent a sequence of single byte characters (ISO-8859-1) or a sequence of 1-4 byte character sequences (UTF-8). (If you put the text in an alert, our &quot;UTF-8&quot; will not be human-readable, while our &quot;ISO-8859-1&quot; will be.)

In JavaScript you can easily discover what the UTF-8 sequence for a character should be by using encodeURIComponent. For the sharp-S, it gives &quot;%C3%9F&quot;, which, translated into a multiple single-byte string sequence is &quot;\u00C3\u009F&quot; or, more visually, &quot;Ã\u009F&quot;. 

In ISO-8859-1, it should simply be &quot;\u00DF&quot; or &quot;ß&quot;.

In other words, we can treat regular JavaScript as though it were ISO-8859-1 since both have a fixed correspondence between a character and number of bytes (ISO-8859-1 is 1-to-1 while UTF-16 is 1 to 2, unless for rare (and non-Latin) characters not present in ISO-8859-1 where the correspondence is 1-to-4; 4-byte characters are necessary in some cases since even 2 bytes is not enough to represent all of the scripts supported by Unicode).

So, &quot;utf8_decode&quot; would only be used if you already have a string of characters in this artificial &quot;UTF-8&quot; where each &quot;character&quot; has up to a full byte of value (0-255)&#8211;representing a single byte in a UTF-8 1-4 byte sequence.

&quot;utf8_encode&quot;, on the other hand, would let you encode a ISO-8859-1 string (or Latin UTF-16 strings) into such an artificial &quot;UTF-8&quot; sequence of 1-2 byte sequences.

If the above doesn&#8217;t help, feel free to clarify exactly what you are trying to do and why.
<hr />


<strong>
Chris Ahrweiler
</strong>
on 2010-01-27 10:06:42 <br />
Hello, 

tried the function, looking good, but german Umlaut &quot;ß&quot; wouldn&#8217;t be converted correctly. Any improved version of this function available?

Regards, Chris.
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-12-30 06:52:42 <br />
@Walessio: The declaration was already there (and for some more variables too), but I think the syntax highlighter doesn&#8217;t accurately insert newlines, so when you copy-paste, it doesn&#8217;t always preserve them. To be safer, just paste from the &quot;raw js source&quot; link.
@Kevin, I think here&#8217;s some proof that it&#8217;d be better to go back to the old commenting system&#8230; The function shows the declaration, but when people copy-paste it, some lines get merged into comments, etc. Sorry for all of these &quot;unfunded&quot; requests&#8230; :)
<hr />


<strong>
Walessio
</strong>
on 2009-12-29 10:28:07 <br />
Bugs found from Firefox 3.0.16 (on Windows Vista):
i is not defined 
tmp_arr is not defined

add this to solve the problem:
var i;
var tmp_arr = new Array();

also, unserialize does not unserialize serialized associative arrays
<hr />


<strong>
<a href="http://brett-zamir.me" rel="nofollow">Brett Zamir</a>
</strong>
on 2009-09-24 02:55:15 <br />
@Michel Corne: Thank you for the function. The site still has some apparent problems with Unicode in comments (if not the function!), so would you mind submitting your code to http://pastebin.com/ and sending us a link?
<hr />


<strong>
<a href="http://mcorne.blogspot.com/" rel="nofollow">Michel Corne</a>
</strong>
on 2009-09-23 17:37:18 <br />
I am afraid there is a problem with this function. Try to convert &quot;à&quot; that is multibyte character. &quot;str_data.length&quot; equals &quot;1&quot; (char) since javascript is UTF-8 compliant. But C1 = 224 that is &gt; 128 and you end up playing with C2 and C3 that don&#8217;t even exist :-) Here is the code I propose. It simply translates the string from UTF-8 to iso-8859-15 (improved from iso-8859-1) with a translation table for all non ASCII characters. Let me know what you think. Thanks, MC.

<pre><code>
function utf8_decode (utf8) {
    // control characters are left for alignment reasons, they will not be used anyway!
    var i, iso885915 = '', 
    utf8ToIso885915 = {
    'NBSP': '\xA0', '¡': '\xA1', '¢': '\xA2', '£': '\xA3', '€': '\xA4', '¥': '\xA5', 'Š': '\xA6', '§': '\xA7', 
    'š': '\xA8', '©': '\xA9', 'ª': '\xAA', '«': '\xAB', '¬': '\xAC', 'SHY': '\xAD', '®': '\xAE', '¯': '\xAF',
    '°': '\xB0', '±': '\xB1', '²': '\xB2', '³': '\xB3', 'Ž': '\xB4', 'µ': '\xB5', '¶': '\xB6', '·': '\xB7', 
    'ž': '\xB8', '¹': '\xB9', 'º': '\xBA', '»': '\xBB', 'Œ': '\xBC', 'œ': '\xBD', 'Ÿ': '\xBE', '¿': '\xBF', 
    'À': '\xC0', 'Á': '\xC1', 'Â': '\xC2', 'Ã': '\xC3', 'Ä': '\xC4', 'Å': '\xC5', 'Æ': '\xC6', 'Ç': '\xC7', 
    'È': '\xC8', 'É': '\xC9', 'Ê': '\xCA', 'Ë': '\xCB', 'Ì': '\xCC', 'Í': '\xCD', 'Î': '\xCE', 'Ï': '\xCF', 
    'Ð': '\xD0', 'Ñ': '\xD1', 'Ò': '\xD2', 'Ó': '\xD3', 'Ô': '\xD4', 'Õ': '\xD5', 'Ö': '\xD6', '×': '\xD7', 
    'Ø': '\xD8', 'Ù': '\xD9', 'Ú': '\xDA', 'Û': '\xDB', 'Ü': '\xDC', 'Ý': '\xDD', 'Þ': '\xDE', 'ß': '\xDF', 
    'à': '\xE0', 'á': '\xE1', 'â': '\xE2', 'ã': '\xE3', 'ä': '\xE4', 'å': '\xE5', 'æ': '\xE6', 'ç': '\xE7', 
    'è': '\xE8', 'é': '\xE9', 'ê': '\xEA', 'ë': '\xEB', 'ì': '\xEC', 'í': '\xED', 'î': '\xEE', 'ï': '\xEF', 
    'ð': '\xF0', 'ñ': '\xF1', 'ò': '\xF2', 'ó': '\xF3', 'ô': '\xF4', 'õ': '\xF5', 'ö': '\xF6', '÷': '\xF7', 
    'ø': '\xF8', 'ù': '\xF9', 'ú': '\xFA', 'û': '\xFB', 'ü': '\xFC', 'ý': '\xFD', 'þ': '\xFE', 'ÿ': '\xFF'
    }
    
    for (i = 0; i &lt; utf8.length; i++){
        iso885915 += utf8ToIso885915[utf8[i]]? utf8ToIso885915[utf8[i]] : utf8[i];
    }

    return iso885915;
}
[/CODE
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2009-05-12 17:51:18 <br />
@ Ben Pettit: There has been some talk about it over at the utf8_encode function. Let's work it out over there, and then - if needed - we'll fix utf8_decode accordingly.
<hr />


<strong>
<a href="www.digimulti.com" rel="nofollow">Ben Pettit</a>
</strong>
on 2009-05-05 01:33:17 <br />
This function had troubles with the utf8_encode function when i included the transport.min.js file into my adobe javascript plugin, while using the md5 function.
The way i fixed it was by adding as the first line:
<pre><code>
str_data = str_data.valueOf();
</code></pre>

Thanks for the great open source library!  I&#8217;m just trying to give back a little bit.
Cheers,
Ben.
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2009-04-03 16:45:52 <br />
@ Tim de Koning: thx for helping out man! 
@ Otto Wyss: Can you confirm this?
<hr />


<strong>
<a href="http://www.kingsquare.nl" rel="nofollow">Tim de Koning</a>
</strong>
on 2009-04-01 16:59:39 <br />
@otto

PHP 
<pre><code>
utf8_encode('Sihlhölzli')
</code></pre>
returns &#8216;SihlhÃ¶lzli&#8217;

JAVASCRIPT
<pre><code>
utf8_decode('SihlhÃ¶lzli');
</code></pre>
returns &#8216;Sihlhölzli&#8217;

Seems fine to me&#8230;?

<hr />


<strong>
<a href="http://www.orpatec.ch/index.php?page=gallery.php" rel="nofollow">Otto Wyss</a>
</strong>
on 2009-04-01 10:07:48 <br />
I&#8217;ve a folder name &quot;Sihlhölzli&quot; which I utf8_encode on the server with PHP. This gives me &quot;Sihlh\u00f6lzli&quot; and if it&#8217;s displayed by the browser it nicely shows &quot;Sihlhölzli&quot;. Of course I can&#8217;t use this name to load an image therefore use the utf8_decode in Javascript to decode the name. Unfortunately that doesn&#8217;t work, not even the browser can display it. Any idea whats wrong?
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-10-06 12:25:11 <br />
@ hitwork: Wow thank you hitwork!
<hr />


<strong>
hitwork
</strong>
on 2008-10-05 15:07:13 <br />
There is an error in this function on the following line

} else if ((c1 &amp;gt; 191) &amp;amp;&amp;amp; (c &amp;lt; 224)) {

it should be c1&amp;lt;224

br,
margus
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-09-21 21:43:25 <br />
@ Norman: Thank you, fixed. What do you mean by 2 times htmlentities though?
<hr />


<strong>
Norman &quot;zEh&quot; Fuchs
</strong>
on 2008-09-18 15:22:00 <br />
.. and c3 declaration is missing :D
<hr />


<strong>
Norman &quot;zEh&quot; Fuchs
</strong>
on 2008-09-18 15:20:30 <br />
2 times htmlentities -.-

#3. .. &amp;amp;quot;zEh&amp;amp;quot;
<hr />


<strong>
Norman &quot;zEh&quot; Fuchs
</strong>
on 2008-09-18 15:19:19 <br />
Unused c1 - fix it : )
<hr />


<strong>
<a href="http://kevin.vanzonneveld.net" rel="nofollow">Kevin van Zonneveld</a>
</strong>
on 2008-05-08 21:56:26 <br />
@ Aman Gupta: Thanks I&#8217;ve updated all of the base64 &amp;amp; utf functions based on your findings.
<hr />


<strong>
Aman Gupta
</strong>
on 2008-05-08 01:42:51 <br />
This implementation is extremely slow in IE due to string concatenation. It is much faster to push onto an array and return array.join(&#8221;).
<hr />


</div>


  
    <footer>
      
      
        <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://phpjs.org/functions/utf8_decode/index.html" data-via="phpjs" data-counturl="http://phpjs.org/functions/utf8_decode/index.html" >Tweet</a>
  
  
  <div class="g-plusone" data-size="medium"></div>
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

      
    </footer>
  
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>


    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - Kevin van Zonneveld -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
   -
  <span class="credit">Theme by <a href="http://melandri.net/2012/07/23/darkstripes-octopress-theme-released/">alessandro melandri</a></span>
</p>
</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'phpjs';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://phpjs.org/functions/utf8_decode/index.html';
        var disqus_url = 'http://phpjs.org/functions/utf8_decode/index.html';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
